<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Shane Hsi Rocks]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://shane.hsi.rocks/"/>
  <updated>2016-01-18T14:14:47.000Z</updated>
  <id>http://shane.hsi.rocks/</id>
  
  <author>
    <name><![CDATA[Shane Hsi]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Learn Redux]]></title>
    <link href="http://shane.hsi.rocks/2016/01/16/Learn-Redux/"/>
    <id>http://shane.hsi.rocks/2016/01/16/Learn-Redux/</id>
    <published>2016-01-16T05:01:29.000Z</published>
    <updated>2016-01-18T14:14:47.000Z</updated>
    <content type="html"><![CDATA[<h2 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h2><h3 id="u4F7F_u7528_u573A_u666F"><a href="#u4F7F_u7528_u573A_u666F" class="headerlink" title="使用场景"></a>使用场景</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="title">Router</span> <span class="attribute">history</span>=<span class="value">&#123;history&#125;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">Route</span> <span class="attribute">component</span>=<span class="value">&#123;AppContainer&#125;</span> <span class="attribute">path</span>=<span class="value">'/'</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">Router</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">Provider</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>然后必须和 connect 结合使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    counters: state.counters</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@connect(select)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppContainer</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">IAppContainerProps</span>, </span>&#123;&#125;&gt; &#123;</span><br><span class="line">  public render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; dispatch &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">const</span> actions = bindActionCreators(CounterActions, dispatch);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="title">App</span> <span class="attribute">name</span>=<span class="value">"John"</span> <span class="attribute">actions</span>=<span class="value">&#123;actions&#125;</span>/&gt;</span></span><br><span class="line">    )</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="u6E90_u7801"><a href="#u6E90_u7801" class="headerlink" title="源码"></a>源码</h3><p>仅提取核心部分：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Component, Children &#125; = <span class="built_in">require</span>(<span class="string">'react'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Provider</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 表示 this.store 会被 Provider 的 children 通过 context 获取</span></span><br><span class="line">  getChildContext() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; store: <span class="keyword">this</span>.store &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  constructor(props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props, context)</span><br><span class="line">    <span class="keyword">this</span>.store = props.store</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; children &#125; = <span class="keyword">this</span>.props</span><br><span class="line">    <span class="comment">// 仅仅是对 children 的无 DOM 包装</span></span><br><span class="line">    <span class="keyword">return</span> Children.only(children)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Provider</span><br></pre></td></tr></table></figure>
<h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2><h3 id="u4F7F_u7528_u573A_u666F-1"><a href="#u4F7F_u7528_u573A_u666F-1" class="headerlink" title="使用场景"></a>使用场景</h3><p>使用场景已经介绍过:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    counters: state.counters</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">connect(select)(view)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这里 connect 是 curry 高阶函数。</p>
<h3 id="u6E90_u7801-1"><a href="#u6E90_u7801-1" class="headerlink" title="源码"></a>源码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">mapStateToProps, mapDispatchToProps, mergeProps, options = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapWithConnect</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Connect</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Copies non-react specific statics from a child component to a parent component. Similar to Object.assign, but with React static keywords blacklisted from being overridden.</span></span><br><span class="line">        <span class="comment">// https://github.com/mridgway/hoist-non-react-statics</span></span><br><span class="line">        <span class="comment">// hoistNonReactStatics(targetComponent, sourceComponent)</span></span><br><span class="line">        <span class="comment">// 即将被 connect wrapper 的 component 的 keys，除去 contextTypes，mixins，defaultProps，displayName 等，复制到 Connect 上，并返回 Connect</span></span><br><span class="line">        <span class="keyword">return</span> hoistStatics(Connect, WrappedComponent)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = connect;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h2><h3 id="u4F7F_u7528_u573A_u666F"><a href="#u4F7F_]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Use Router5]]></title>
    <link href="http://shane.hsi.rocks/2016/01/15/Use-Router5/"/>
    <id>http://shane.hsi.rocks/2016/01/15/Use-Router5/</id>
    <published>2016-01-15T09:12:45.000Z</published>
    <updated>2016-01-18T14:14:52.000Z</updated>
    <content type="html"><![CDATA[<p>Router5 的<a href="http://router5.github.io/docs/understanding-router5.html" target="_blank" rel="external">文档</a> 对 router 的解释非常直观详尽，是深入理解 SPA 中 router 的很好资料。其对 react 的绑定，<a href="http://router5.github.io/docs/with-react.html#/inbox" target="_blank" rel="external">react-router5</a> 的实现也很简单直观。理解越多，使用越灵活，功能就越强大。</p>
<h2 id="Get_started"><a href="#Get_started" class="headerlink" title="Get started"></a>Get started</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> router5</span><br></pre></td></tr></table></figure>
<p>其接口：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> router5 = <span class="built_in">require</span>(<span class="string">'router5'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// router5.Router5</span></span><br><span class="line"><span class="comment">// router5.RouteNode</span></span><br></pre></td></tr></table></figure>
<p>提供的插件：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> router5-listeners</span><br><span class="line">npm <span class="keyword">install</span> router5-history</span><br></pre></td></tr></table></figure>
<p>Code example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Router5 &#125; <span class="keyword">from</span> <span class="string">'router5'</span>;</span><br><span class="line"><span class="keyword">import</span> historyPlugin <span class="keyword">from</span> <span class="string">'router5-history'</span>;</span><br><span class="line"><span class="keyword">import</span> listenersPlugin <span class="keyword">from</span> <span class="string">'router5-listeners'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router()</span><br><span class="line">    .addNode(<span class="string">'home'</span>, <span class="string">'/home'</span>)</span><br><span class="line">    .usePlugin(historyPlugin())</span><br><span class="line">    .usePlugin(listenersPlugin())</span><br><span class="line">    <span class="comment">// Development helper</span></span><br><span class="line">    .usePlugin(Router5.loggerPlugin())</span><br><span class="line">    .start();</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">router.canDeactivate(<span class="string">'home'</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">// is the equivalent of, 为 0.x 的写法，canDeactivate 是 shortcut version</span></span><br><span class="line">router.registerComponent(<span class="string">'home'</span>, &#123;</span><br><span class="line">    canDeactivate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Configuring_routes"><a href="#Configuring_routes" class="headerlink" title="Configuring routes"></a>Configuring routes</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router5()</span><br><span class="line">    .setOption(<span class="string">'useHash'</span>, <span class="literal">true</span>)</span><br><span class="line">    <span class="comment">// .setOption('hashPrefix', '!')</span></span><br><span class="line">    .setOption(<span class="string">'defaultRoute'</span>, <span class="string">'inbox'</span>)</span><br><span class="line">    <span class="comment">// Routes</span></span><br><span class="line">    .addNode(<span class="string">'inbox'</span>,         <span class="string">'/inbox'</span>)</span><br><span class="line">    .addNode(<span class="string">'inbox.message'</span>, <span class="string">'/message/:id'</span>)</span><br><span class="line">    .addNode(<span class="string">'compose'</span>,       <span class="string">'/compose'</span>)</span><br><span class="line">    .addNode(<span class="string">'contacts'</span>,      <span class="string">'/contacts'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> Router5([], &#123;</span><br><span class="line">        useHash: <span class="literal">true</span>,</span><br><span class="line">        hashPrefix: <span class="string">'!'</span>,</span><br><span class="line">        defaultRoute: <span class="string">'home'</span>,</span><br><span class="line">        defaultParams: &#123;&#125;,</span><br><span class="line">        base: <span class="string">''</span>,</span><br><span class="line">        trailingSlash: <span class="literal">false</span>,</span><br><span class="line">        autoCleanUp: <span class="literal">true</span>,</span><br><span class="line">        strictQueryParams: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .setOption(<span class="string">'useHash'</span>, <span class="literal">false</span>)</span><br><span class="line">    .setOption(<span class="string">'hashPrefix'</span>, <span class="string">''</span>);</span><br></pre></td></tr></table></figure>
<p>useHash，hashPrefix 会被 <code>router5-history</code> 用到。</p>
<p>defaultRoute，defaultParams 会被用作默认 navigation。</p>
<h2 id="Preventing_navigation"><a href="#Preventing_navigation" class="headerlink" title="Preventing navigation"></a>Preventing navigation</h2><p>场景，允许/阻止用户进入下一个 view：比如用户在填写表单，未保存之前，给出提示，并禁止离开当前 view。</p>
<h2 id="u6574_u4F53_u611F_u53D7"><a href="#u6574_u4F53_u611F_u53D7" class="headerlink" title="整体感受"></a>整体感受</h2><p>最终还是选择了先使用 <code>react-router</code>。</p>
<p>router5 整体的文档非常清楚，设计感和覆盖场景也很现实常用。只可惜 react-router5 的很多很变扭，而且还需要很多的 biolerplate 代码，最关键的是 NotFound 的设计很原始。</p>
<p>Anyway，有机会自己实现一个。对 router 也是一种熟悉。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Router5 的<a href="http://router5.github.io/docs/understanding-router5.html" target="_blank" rel="external">文档</a> 对 router 的解释非常直观详尽，是深入理]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Write a Webpack Plugin]]></title>
    <link href="http://shane.hsi.rocks/2016/01/14/Write-a-Webpack-Plugin/"/>
    <id>http://shane.hsi.rocks/2016/01/14/Write-a-Webpack-Plugin/</id>
    <published>2016-01-14T09:56:38.000Z</published>
    <updated>2016-01-18T14:14:57.000Z</updated>
    <content type="html"><![CDATA[<p>Plugin 介入的是 Webpack build process。也就是说，在 Webpack build 时，做一些其他的工作（然后可以拿到 Webpack build 时的一些 context）。</p>
<p>Plugin 需要理解 Webpack 的一些 low-level 的内部机制，然后 hook into。要读一些 source code。</p>
<h2 id="Compiler_and_Compilation"><a href="#Compiler_and_Compilation" class="headerlink" title="Compiler and Compilation"></a>Compiler and Compilation</h2><p>开发 plugin 要知晓两个对象 <code>compiler</code>，<code>compilation</code>。</p>
<ul>
<li><p><code>compiler</code> 相当于 Webpck 的 context，并且是配置过的，也就是说，可以拿到 Webpack 的配置比如，options，loaders，plugins。每一个 plguin 都会获得一个对 <code>compiler</code> 的引用。</p>
</li>
<li><p><code>compilation</code> 对应于一个版本的 assets 的 build。因为在运行 Webpack development middleware 时，每次文件变动被探测到，都会有一个新的 compilation，生成一次新的 compiled assets。所以，<code>compilation</code> 代表了 module resources，compiled assets，changed files 和 watched dependencies 的当前状态。还提供了很多 callback points，让 plugin 来做些自定义操作。</p>
</li>
</ul>
<h2 id="Basic_plugin_architecture"><a href="#Basic_plugin_architecture" class="headerlink" title="Basic plugin architecture"></a>Basic plugin architecture</h2><p>Plugins 是实例化对象，prototype 上必须有 <code>apply</code> 方法，它会在 Webpack 安装这个 plugin 时调用。apply 会得到一个 Webpack compiler 的引用，并被赋权使用 compiler 的 callbacks。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HelloWorldPlugin</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Setup the plugin instance with options...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HelloWorldPlugin.prototype.apply = <span class="function"><span class="keyword">function</span>(<span class="params">compiler</span>) </span>&#123;</span><br><span class="line">  compiler.plugin(<span class="string">'done'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>); </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = HelloWorldPlugin;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> HelloWorldPlugin = <span class="built_in">require</span>(<span class="string">'hello-world'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> webpackConfig = &#123;</span><br><span class="line">  <span class="comment">// ... config settings here ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HelloWorldPlugin(&#123;options: <span class="literal">true</span>&#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="Accessing_the_compilation"><a href="#Accessing_the_compilation" class="headerlink" title="Accessing the compilation"></a>Accessing the compilation</h2><p>如何访问 <code>compilation</code> 对象呢？通过使用 <code>compiler</code> 的回调。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HelloCompilationPlugin</span>(<span class="params">options</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">HelloCompilationPlugin.prototype.apply = <span class="function"><span class="keyword">function</span>(<span class="params">compiler</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置回调，访问 compilation</span></span><br><span class="line">  compiler.plugin(<span class="string">"compilation"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">compilation</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置回调，访问 compilation 的 steps</span></span><br><span class="line">    compilation.plugin(<span class="string">"optimize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"Assets are being optimized."</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = HelloCompilationPlugin;</span><br></pre></td></tr></table></figure>
<p>关于 <code>complier</code>，<code>compilation</code> 更多的信息参看 <a href="https://webpack.github.io/docs/plugins.html" target="_blank" rel="external">plugins API</a>。</p>
<h2 id="Async_compilation_plugins"><a href="#Async_compilation_plugins" class="headerlink" title="Async compilation plugins"></a>Async compilation plugins</h2><p>异步这块暂时不看。</p>
<h2 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h2><p>以上是 high-level 的文档，这里是具体的细节。</p>
<p>Webpack 的很多对象都继承 Tabable class，后者会暴露一个 <code>plugin</code> 方法。通过 <code>plugin</code> 方法，plugins 会 inject custom build steps。比如：<code>compiler.plugin</code> 和 <code>compilation.plugin</code>。</p>
<p>具体说，对于 plguin 的调用会绑定在 build process 的特定步骤。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/ MyPlugin.js</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPlugin</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Configure your plugin with options...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPlugin.prototype.apply = <span class="function"><span class="keyword">function</span>(<span class="params">compiler</span>) </span>&#123;</span><br><span class="line">  compiler.plugin(<span class="string">"compile"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 开始 compile</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"The compiler is starting to compile..."</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">"compilation"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">compilation</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 一个新的 compilation</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"The compiler is starting a new compilation..."</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optimize 步骤</span></span><br><span class="line">    compilation.plugin(<span class="string">"optimize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"The compilation is starting to optimize files..."</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">"emit"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">compilation, callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 开始emit 生成的 assets，此时是 plugin 往 c.assets (c: Compilation) 数组增加 assets 的最后机会</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"The compilation is going to emit files..."</span>);</span><br><span class="line">    callback();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = MyPlugin;</span><br></pre></td></tr></table></figure>
<p>全部的 steps，参见 <a href="https://webpack.github.io/docs/plugins.html#the-compiler-instance" target="_blank" rel="external">THE COMPILER INSTANCE</a>。</p>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>该例子很简单，从文件系统拿到一个值，放入 compilation 的 assets。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HtmlPlugin</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.options = options ? options : &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HtmlPlugin.prototype.apply = <span class="function"><span class="keyword">function</span>(<span class="params">compiler</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">"emit"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">compilation, callback</span>) </span>&#123;</span><br><span class="line">    that.addFileToWebpackAsset(compilation);</span><br><span class="line">    callback();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">HtmlPlugin.prototype.addFileToWebpackAsset = <span class="function"><span class="keyword">function</span>(<span class="params">compilation</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> template = path.join(__dirname, <span class="string">'default-pc.html'</span>);</span><br><span class="line">  <span class="keyword">var</span> filename = path.resolve(template);</span><br><span class="line">  compilation.fileDependencies.push(filename);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> outFilename = path.basename(that.options.filename || <span class="string">'index.html'</span>);</span><br><span class="line">  compilation.assets[outFilename] = &#123;</span><br><span class="line">    source: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> fs.readFileSync(filename).toString();</span><br><span class="line">    &#125;,</span><br><span class="line">    size: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> fs.statSync(filename).size;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = HtmlPlugin;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>Plugin 介入的是 Webpack build process。也就是说，在 Webpack build 时，做一些其他的工作（然后可以拿到 Webpack build 时的一些 context）。</p>
<p>Plugin 需要理解 Webpack 的一些 low-]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Scaffold and Tools for Front-end (will update regularly)]]></title>
    <link href="http://shane.hsi.rocks/2016/01/13/Scaffold-and-Tools-for-Front-end-to-update/"/>
    <id>http://shane.hsi.rocks/2016/01/13/Scaffold-and-Tools-for-Front-end-to-update/</id>
    <published>2016-01-13T06:36:49.000Z</published>
    <updated>2016-01-18T14:24:45.000Z</updated>
    <content type="html"><![CDATA[<p>技术栈：</p>
<ul>
<li>TypeScript</li>
<li>React</li>
<li>Webpack</li>
<li>Babel</li>
<li>PostCSS &amp; CSS Modules</li>
<li>React Router</li>
<li>Redux</li>
<li>IE8 兼容性</li>
<li>Ajax 库</li>
</ul>
<h2 id="Only_TypeScript_u2019s_Type"><a href="#Only_TypeScript_u2019s_Type" class="headerlink" title="Only TypeScript’s Type"></a>Only TypeScript’s Type</h2><p>其中 TypeScript 借助 IDE（如 webstorm）或者直接命令行 <code>tsc --watch</code> 编译成 <code>/\.jsx?$/</code>。也就是说，虽然用了 Webpack，但是没有使用 Webpack 的 TypeScript loader，保证出去这一步外，和使用 ES6 开发相同。<code>tsconfig.json</code> 如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "<span class="attribute">compilerOptions</span>": <span class="value">&#123;</span><br><span class="line">    "<span class="attribute">target</span>": <span class="value"><span class="string">"es2015"</span></span>,</span><br><span class="line">    "<span class="attribute">module</span>": <span class="value"><span class="string">"es2015"</span></span>,</span><br><span class="line">    "<span class="attribute">jsx</span>": <span class="value"><span class="string">"preserve"</span></span><br><span class="line">  </span>&#125;</span>,</span><br><span class="line">  "<span class="attribute">exclude</span>": <span class="value">[</span><br><span class="line">    <span class="string">"node_modules"</span></span><br><span class="line">  ]</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
<p>使用 TypeScript 并不会增加学习的曲线，目前仅仅是使用 TypeScript 中的 Type 系统，做 compile 期的类型检查，而不是在运行时（比如使用 PropTypes）。</p>
<p>我们来看几个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params">type:string, actionCreator?:any</span>):(<span class="params">...args:any[]</span>) =&gt; <span class="title">IAction</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里用到了 <code>...args:any[]</code>，表明 <code>arguments</code> 是 array-like 的类型。并且 action 的返回值的类型是 <code>(...args:any[]) =&gt; IAction</code> 表明这是 curry。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">onActions</span>(<span class="params">handlers:&#123;[key: string]: Reducer&#125;, initialState:Object</span>):<span class="title">Reducer</span> </span>&#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这里的是如何对 Dictionary 做类型，<code>{[key: string]: Reducer}</code>。</p>
<h2 id="Based_on_react-transform-boilerplate"><a href="#Based_on_react-transform-boilerplate" class="headerlink" title="Based on react-transform-boilerplate"></a>Based on react-transform-boilerplate</h2><p>其余即基于 <a href="https://github.com/gaearon/react-transform-boilerplate" target="_blank" rel="external">react-transform-boilerplate</a>。</p>
<p>没有多余的配置，由浅入深。</p>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><p>对于移动端，参考 <a href="https://github.com/weui/weui/blob/master/dist/style/weui.css" target="_blank" rel="external">weui</a>，但是只初步将其中的 weui-rest.css 和 weui-font.css（本身并没有这些文件，这里只是逻辑分块）作为全局 css。</p>
<p>并参考 <a href="https://github.com/corysimmons/boy" target="_blank" rel="external">boy</a> 项目。</p>
<h2 id="React_Router"><a href="#React_Router" class="headerlink" title="React Router"></a>React Router</h2><p>首先，并没有说使用 Redux 来管理 router history。</p>
<p>另外，我是想自己写一个 router 的。</p>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>Redux 之前看过一遍源码，整体的实现原理，包括响应式的实现，而且 reducer 的 hot reload 等。前几天开始重新整理下源码的思路。</p>
<h2 id="IE8__u517C_u5BB9_u6027"><a href="#IE8__u517C_u5BB9_u6027" class="headerlink" title="IE8 兼容性"></a>IE8 兼容性</h2><p>React 本身支持 IE9+，使用 es5-shim 可以支持到 IE8+。另外还有一点是，default 保留字是不允许 <code>exports.default</code>，所以要使用 es3ify 转换成 <code>exports[&#39;default&#39;]</code>。本身是不增加代码量就可以兼容。</p>
<p>兼容 polyfill:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--[if lt IE 9]&gt;</span><br><span class="line">&lt;script src="/assets/js/vendor/es5-shim.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="/assets/js/vendor/es5-sham.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;![endif]--&gt;</span></span><br></pre></td></tr></table></figure>
<p>另外，也要考虑使用的依赖和编写的组件是否兼容。而且这些只有在写的过程中不断地在 IE8 测试，总之不是轻松的活计。</p>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><p>Ajax 库感兴趣完全可以自己写一个，相对比较固定的写法。网上类似的参考也很多。</p>
<ul>
<li><a href="https://github.com/ForbesLindesay/ajax" target="_blank" rel="external">ForbesLindesay/ajax</a></li>
<li><a href="https://github.com/ma3uk/ajax" target="_blank" rel="external">ma3uk/ajax</a></li>
<li><a href="https://gist.github.com/mythz/1334560" target="_blank" rel="external">mythz/xhr.js</a></li>
<li><a href="https://github.com/dexteryy/mo" target="_blank" rel="external">dexteryy/mo</a></li>
</ul>
<p>目前使用 <a href="https://github.com/visionmedia/superagent" target="_blank" rel="external">superagent</a>，是因为发现它的 response 的类型很丰富。</p>
<h2 id="To_be_continued"><a href="#To_be_continued" class="headerlink" title="To be continued"></a>To be continued</h2>]]></content>
    <summary type="html">
    <![CDATA[<p>技术栈：</p>
<ul>
<li>TypeScript</li>
<li>React</li>
<li>Webpack</li>
<li>Babel</li>
<li>PostCSS &amp; CSS Modules</li>
<li>React Router</li>]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Read TypeScript Blog, Announcing TypeScript 1.7]]></title>
    <link href="http://shane.hsi.rocks/2016/01/13/Read-TypeScript-Blog-Announcing-TypeScript-1-7/"/>
    <id>http://shane.hsi.rocks/2016/01/13/Read-TypeScript-Blog-Announcing-TypeScript-1-7/</id>
    <published>2016-01-13T02:10:24.000Z</published>
    <updated>2016-01-18T14:14:50.000Z</updated>
    <content type="html"><![CDATA[<p>更新：</p>
<ul>
<li>对于 ES6 targets，默认打开 async/await</li>
<li>polymorphic ‘this’ typing</li>
<li>ES2016 的 exponentiation 语法</li>
<li>ES6 module targeting</li>
</ul>
<h2 id="Async/Await_for_ES6_targets"><a href="#Async/Await_for_ES6_targets" class="headerlink" title="Async/Await for ES6 targets"></a>Async/Await for ES6 targets</h2><p><a href="http://tc39.github.io/ecmascript-asyncawait/" target="_blank" rel="external">Asyc functions</a>，需要 <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-generator-function-definitions" target="_blank" rel="external">ES6 generator</a> 支持（比如 node.js v4 及以上）。</p>
<p>函数通过 <code>async</code> 关键词指定它为一个 asynchronous function。</p>
<p><code>await</code>关键词用来停止执行（stop execution），直到 <code>async</code> 函数的 promise 已经 fulfilled。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">"use strict"</span>;</span><br><span class="line"><span class="comment">// printDelayed is a 'Promise&lt;void&gt;'</span></span><br><span class="line">async <span class="function"><span class="keyword">function</span> <span class="title">printDelayed</span>(<span class="params">elements: <span class="built_in">string</span>[]</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> element of elements) &#123;</span><br><span class="line">        await delay(<span class="number">200</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">async <span class="function"><span class="keyword">function</span> <span class="title">delay</span>(<span class="params">milliseconds: <span class="built_in">number</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Promise&lt;<span class="built_in">void</span>&gt;(resolve =&gt; &#123;</span><br><span class="line">        setTimeout(resolve, milliseconds);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">printDelayed([<span class="string">"Hello"</span>, <span class="string">"beautiful"</span>, <span class="string">"asynchronous"</span>, <span class="string">"world"</span>]).then(() =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Printed every element!"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>对于目前对 async/await 的实现，参考上一篇<a href="http://blogs.msdn.com/b/typescript/archive/2015/11/03/what-about-async-await.aspx" target="_blank" rel="external">博客</a>。</p>
<h2 id="Polymorphic_this_Typing"><a href="#Polymorphic_this_Typing" class="headerlink" title="Polymorphic this Typing"></a>Polymorphic <code>this</code> Typing</h2><p>背景见 <a href="https://github.com/Microsoft/TypeScript/issues/229" target="_blank" rel="external">issue</a>。</p>
<p>这是 TypeScript 1.7 新增的类型。</p>
<p><code>this</code> 类型可以用在 classes 和 interfaces 里，表示某种类型，它是 containing type 的 subtype（而不是 containing type）。</p>
<p>关于多态这个计算机科学词汇，这里加深下理解。</p>
<p>我们先以 <a href="https://msdn.microsoft.com/zh-cn/library/ms173152.aspx" target="_blank" rel="external">C#中的多态性为例</a> 理解：</p>
<p>多态指两个方面：</p>
<ul>
<li>运行时，在 方法参数、集合或数组等位置，派生类的对象可以作为基类的对象处理。即，对象的声明类型不再与运行时相同。</li>
<li>基类可以定义并实现虚方法，派生类可以重写（override）这些方法，即派生类提供自己的定义和实现。运行时，CLR 查找对象的<strong>运行时</strong>定义，调用虚方法的重写方法。即，你可以调用基类的方法，但执行的是派生类版本。</li>
</ul>
<p>这些是在 C# 中的实践，再来看下<a href="https://zh.wikipedia.org/wiki/%E5%A4%9A%E5%9E%8B_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6" target="_blank" rel="external">维基百科</a>的定义：</p>
<blockquote>
<p>多态，是指计算机程序运行时，相同的消息可能会送给多个不同的类之对象，而系统可依据对象所属类，引发对应类的方法，而有不同的行为。<br>多态也可定义为“一种将不同的特殊行为和单个泛化记号相关联的能力”。</p>
</blockquote>
<p>这里先重点关于下<strong>动态多态（dynamic polymorphism）</strong>：通过类继承机制和虚函数机制生效于运行期。可以优雅地处理异质对象集合，只要其共同的基类定义了虚函数的接口。也被称为子类型多态（Subtype polymorphism）或包含多态（inclusion polymorphism）。在面向对象程序设计中，这被直接称为多态。</p>
<p>另外提及一点，静态多态中的参数化多态（Parametric polymorphism），把类型作为参数的多态。在面向对象程序设计中，这被称作<a href="https://zh.wikipedia.org/wiki/%E6%B3%9B%E5%9E%8B" target="_blank" rel="external">泛型编程</a>。</p>
<p>现在回头再看下 TypeScript 1.7 引入的多态 <code>this</code> 类型：</p>
<blockquote>
<p><code>this</code> 类型可以用在 classes 和 interfaces 里，表示某种类型，它是 containing type 的 subtype（而不是 containing type）。</p>
</blockquote>
<p>这个特性可以帮助容易写出某些 patterns，比如：hierachical fluent APIs，层级流式 API。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="interface"><span class="keyword">interface</span> Model </span>&#123;</span><br><span class="line">    setupBase(): <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="interface"><span class="keyword">interface</span> AdvancedModel <span class="keyword">extends</span> Model </span>&#123;</span><br><span class="line">    setupAdvanced(): <span class="keyword">this</span>;  <span class="comment">// 返回值是 this，这个 this 既可以是指本身，也可以指基类</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="function"><span class="keyword">function</span> <span class="title">createModel</span>(<span class="params"></span>): <span class="title">AdvancedModel</span></span>;</span><br><span class="line">newModel = newModel.setupBase().setupAdvanced(); <span class="comment">// fluent style works</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>问：TypeScript 中的 <code>declare</code> 关键词是指？</p>
</blockquote>
<p>关于 <code>this</code> 的更多信息，参考 <a href="https://github.com/Microsoft/TypeScript/wiki/What%27s-new-in-TypeScript#this-typing" target="_blank" rel="external">TypeScript Wiki</a>。</p>
<p>为了支持这个特性，TypeScript 1.7 对从 <code>this</code> 推导（inferring）type 做了些许变更。大致一些<a href="https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#TypeScript1.7" target="_blank" rel="external">潜在的 breaking changes</a>：</p>
<blockquote>
<p>In a class, the type of the value this will be inferred to the this type, and subsequent assignments from values of the original type can fail. As a workaround, you could add a type annotation for this. A code sample with recommended work around, along with a list of other potentially breaking changes is available at GitHub.</p>
</blockquote>
<h2 id="ES6_Module_Emitting"><a href="#ES6_Module_Emitting" class="headerlink" title="ES6 Module Emitting"></a>ES6 Module Emitting</h2><p>Node.js v4+，支持很多 ES6 特性，但是不支持 ES6 modules，可以如下配置，适应 Node.js v4+ 的 runtime。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//tsconfig.json targeting node.js v4 and beyond</span><br><span class="line">&#123;</span><br><span class="line">    "compilerOptions": &#123;</span><br><span class="line">        "module": "commonjs",</span><br><span class="line">        "target": "es6"</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ES7_Exponentiation"><a href="#ES7_Exponentiation" class="headerlink" title="ES7 Exponentiation"></a>ES7 Exponentiation</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> squared = <span class="number">2</span> ** <span class="number">2</span>;  <span class="comment">// same as: 2 * 2</span></span><br><span class="line"><span class="keyword">let</span> cubed = <span class="number">2</span> ** <span class="number">3</span>;  <span class="comment">// same as: 2 * 2 * 2</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">2</span>;</span><br><span class="line">num **= <span class="number">2</span>; <span class="comment">// same as: num = num * num;</span></span><br></pre></td></tr></table></figure>
<p>和 <code>Math.pow()</code> 说 Byebye。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>更新：</p>
<ul>
<li>对于 ES6 targets，默认打开 async/await</li>
<li>polymorphic ‘this’ typing</li>
<li>ES2016 的 exponentiation 语法</li>
<li>ES6 modu]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://shane.hsi.rocks/2015/12/21/hello-world/"/>
    <id>http://shane.hsi.rocks/2015/12/21/hello-world/</id>
    <published>2015-12-21T07:45:00.000Z</published>
    <updated>2015-12-26T08:01:23.000Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start"><a href="#Quick_Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create_a_new_post"><a href="#Create_a_new_post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server"><a href="#Run_server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files"><a href="#Generate_static_files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites"><a href="#Deploy_to_remote_sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io]]>
    </summary>
    
  </entry>
  
</feed>
