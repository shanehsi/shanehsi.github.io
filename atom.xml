<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Shane Hsi Rocks]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://shane.hsi.rocks/"/>
  <updated>2016-04-28T06:55:13.000Z</updated>
  <id>http://shane.hsi.rocks/</id>
  
  <author>
    <name><![CDATA[Shane Hsi]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[单向 UI 架构]]></title>
    <link href="http://shane.hsi.rocks/2016/04/28/UNIDIRECTIONAL-USER-INTERFACE-ARCHITECTURES/"/>
    <id>http://shane.hsi.rocks/2016/04/28/UNIDIRECTIONAL-USER-INTERFACE-ARCHITECTURES/</id>
    <published>2016-04-28T06:12:43.000Z</published>
    <updated>2016-04-28T06:55:13.000Z</updated>
    <content type="html"><![CDATA[<ul>
<li><strong>User events</strong></li>
<li><strong>User interface rendering</strong> 在屏幕上的图形输出，通常表示为HTML或一些可比高级别声明性代码如JSX。</li>
<li><strong>UI</strong> 它接受用户事件作为输入，并输出渲染，一个持续的过程，而不是一次性的变换。</li>
</ul>
<blockquote>
<p>A unidirectional architecture is said to be <strong>fractal</strong> if subcomponents are structured in the same way as the whole is.</p>
</blockquote>
<p>单向被认为是 fractal（分形），如果子组件的组织方式是统一的。</p>
<p>In fractal architectures, the whole can be naively packaged as a component to be used in some larger application.</p>
<p>In non-fractal architectures, the non-repeatable parts are said to be orchestrators over the parts that have hierarchical composition.</p>
<p>非分形架构中，非重复模块和其他模块需要特定的协调器。</p>
<h2 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h2><ul>
<li><p>Dispatcher 是 singleton。</p>
</li>
<li><p>Only View has composable components.</p>
<p>  A React component is a UI program, and is usually not written as a Flux architecture internally. Hence Flux is not fractal, where the <strong>orchestrators</strong> are the <strong>Dispatcher</strong> and the <strong>Stores</strong>.</p>
</li>
<li><p>User event handlers are declared in the rendering. event 在 rendering 里声明</p>
<p>  <code>onClick={this.clickHandler}</code></p>
</li>
</ul>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>Redux is a variation of Flux where the <strong>singleton Dispatcher</strong> was adapted to become <strong>a singleton Store</strong>. </p>
<ul>
<li>Singleton Store</li>
<li>Provider</li>
<li>Provider</li>
<li>Reducers</li>
</ul>
<h3 id="Peculiarities"><a href="#Peculiarities" class="headerlink" title="Peculiarities"></a>Peculiarities</h3><p>Like Flux, Redux is not (by design) fractal and the <strong>Store</strong> is an <strong>orchestrator</strong>.</p>
<h2 id="Elm"><a href="#Elm" class="headerlink" title="Elm"></a>Elm</h2><ul>
<li>Model: a type defining the structure of state data 定义 data 的结构</li>
<li>View: a pure function transforming state into rendering 将 state 转换成rendering</li>
<li>Actions: a type defining user events sent through mailboxes 就是 type</li>
<li>Update: a pure function from previous state and an action to new state 就是 reducer</li>
</ul>
<p>和 redux 相比，他没有一个 store。</p>
<hr>
<p>关于 reactive ？</p>
<img src="/2016/04/28/UNIDIRECTIONAL-USER-INTERFACE-ARCHITECTURES/passive.png" alt="passive.png" title="">
<p>Bar is <strong>passive</strong>: it allows other modules to change its state. Foo is proactive: it is responsible for making Bar’s state function correctly. The passive module is unaware of the existence of the arrow which affects it.</p>
<p>被调用方（passive）不知道调用方（proactive）的存在。Bar 允许其他 modules，比如 Foo 来改变 Bar 本身的状态。</p>
<img src="/2016/04/28/UNIDIRECTIONAL-USER-INTERFACE-ARCHITECTURES/reactive.png" alt="reactive.png" title="">
<p>Bar is <strong>reactive</strong>: it is fully responsible for managing its own state by reacting to external events. Foo, on the other hand, is unaware of the existence of the arrow originating from its network request event.</p>
<p>Bar 完全控制自己的状态。Foo 不知道 Bar 的存在。</p>
<blockquote>
<p>What is the benefit of this approach? Inversion of Control, mainly because Bar is responsible for itself. Plus, we can hide Bar’s incrementCounter() as a private function. In the passive case, it was required to have incrementCounter() public, which means we are exposing Bar’s internal state management outwards. It also means if we want to discover how Bar’s counter works, we need to find all usages of incrementCounter() in the codebase. In this regard, Reactive and Passive seem to be duals of each other.</p>
</blockquote>
<p>IoC，可以隐藏 Bar 的 incrementCounter() 作为私有方法。<strong>如果要知道 Bar incrementCounter() 的工作机制，我们要找到所有 incrementCounter() 被调用的地方</strong></p>
<blockquote>
<p>这个我觉得是重点，public/private 的本身含义很简单，关键就是 private 之后会带来的倾向性。Bar 只相应唯一一个 event 的 payload。Bar 的最终吐出的 state，外界对它的影响要最低。state，主要在 Bar，而不是把 Bar 当做一个改变 state 的操作。</p>
</blockquote>
<hr>
]]></content>
    <summary type="html">
    <![CDATA[<ul>
<li><strong>User events</strong></li>
<li><strong>User interface rendering</strong> 在屏幕上的图形输出，通常表示为HTML或一些可比高级别声明性代码如JSX。</li>
<li><str]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[redux data flow]]></title>
    <link href="http://shane.hsi.rocks/2016/04/27/redux-data-flow/"/>
    <id>http://shane.hsi.rocks/2016/04/27/redux-data-flow/</id>
    <published>2016-04-27T10:22:48.000Z</published>
    <updated>2016-04-28T03:59:31.000Z</updated>
    <content type="html"><![CDATA[<p>原文 1：<a href="https://github.com/jarvisaoieong/redux-architecture" target="_blank" rel="external">jarvisaoieong/redux-architecture</a></p>
<p>In classical Redux, which side effect is handled by thunk middleware, is not fractal (a term that is nicely explained by @stalz)</p>
<p>传统的 redux 中，side effect 是通过 thunk 中间件来处理的，</p>
<p>它不是 <strong><a href="http://staltz.com/unidirectional-user-interface-architectures.html" target="_blank" rel="external">fractal</a></strong> 的</p>
<img src="/2016/04/27/redux-data-flow/redux-architecture.png" alt="redux-architecture.png" title="">
<p>Even with some new Redux additions, like redux-saga, are also not composable in a fractal way with the rest of architecture.</p>
<p>redux-saga 也无法用 fractal 的方式和其他模块进行组合。</p>
<p>I think <a href="https://github.com/evancz/elm-architecture-tutorial/" target="_blank" rel="external">elm architecture</a> has found the proper way to do it right. Beside composing Views, State and Reducers (which are already composed in classical Redux), Actions and Effects should be composed too. All that leads to composition of application pieces at the higher level.</p>
<p>Elm 架构找到了一种正确的解决方式。除了组合 Views，States 和 reducers（redux 已经 compose），Actions 和 Effects 也会被 compose。总体来说，就能将 application pieces 组合到一个高的层级。</p>
<img src="/2016/04/27/redux-data-flow/elm-architecture.png" alt="elm-architecture.png" title="">
<p><strong>注：</strong> 需要理解下 elm</p>
<p>Redux is awesome. In order to make redux architecture fractal. We only need two adjustment in our application.</p>
<ol>
<li><p>Use <a href="https://github.com/raisemarketplace/redux-loop" target="_blank" rel="external">redux-loop</a> as side effect solution. </p>
<p>It will make the effects composable and the reducers more domain centric. It give you elm architecture side effect like solutions. 可以让 effects 变的可以 compose。reducer 更加面向 domain。给了类似 elm 架构的解决方案。</p>
</li>
<li><p>Don’t use <code>bindActionCreators</code>, just pass <code>dispatch</code> as the parameter to the components.</p>
<p>What the component needed is model (the data) and dispatch (a way to communicate with the rest architecture). It doesnt need the action callback as the parameters.不要使用 <code>bindActionCreators</code>，只要将 dispatch 传入 components。component 需要 modal（就是 data 数据）和 dispatch（和应用的其他架构部分做交互的方式）。不需要 action callback。</p>
</li>
</ol>
<p>This repo is port of the elm architecture examples in redux with redux-loop to show the benefits of hierarchical composition everywhere. In this example, I used my fork of <a href="https://github.com/jarvisaoieong/redux-loop" target="_blank" rel="external">redux-loop</a> and <a href="https://github.com/jarvisaoieong/redux-logger" target="_blank" rel="external">redux-logger</a> to demonstrate how to log the high order action and async action. (Please open the console in the <a href="http://jarvisaoieong.github.io/redux-architecture/" target="_blank" rel="external">live demo</a>.)</p>
<p><img src="http://i.imgur.com/33MQJvu.png" alt=""></p>
<img src="/2016/04/27/redux-data-flow/log.png" alt="log.png" title="">
<p>I hope we can make elm architecture to the mainstream to create a truly reusable and well encapsulated application.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>原文 1：<a href="https://github.com/jarvisaoieong/redux-architecture" target="_blank" rel="external">jarvisaoieong/redux-architecture</a></p]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Read recompose API]]></title>
    <link href="http://shane.hsi.rocks/2016/04/23/Read-recompose-API/"/>
    <id>http://shane.hsi.rocks/2016/04/23/Read-recompose-API/</id>
    <published>2016-04-22T23:14:48.000Z</published>
    <updated>2016-04-22T23:19:32.000Z</updated>
    <content type="html"><![CDATA[<h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><h2 id="u6570_u636E_u6D41"><a href="#u6570_u636E_u6D41" class="headerlink" title="数据流"></a>数据流</h2><p>这种方式不好用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Counter = withState(</span><br><span class="line">  <span class="string">'counter'</span>, <span class="string">'setCounter'</span>, <span class="number">0</span></span><br><span class="line">)((&#123; counter, setCounter &#125;) =&gt; (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">      Count: &#123;counter&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="title">button</span> <span class="attribute">onClick</span>=<span class="value">&#123;()</span> =&gt;</span> setCounter(n =&gt; n + 1)&#125;&gt;Increment<span class="tag">&lt;/<span class="title">button</span>&gt;</span> /&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="title">button</span> <span class="attribute">onClick</span>=<span class="value">&#123;()</span> =&gt;</span> setCounter(n =&gt; n - 1)&#125;&gt;Decrement<span class="tag">&lt;/<span class="title">button</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  )</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>√ 这种方式符合 redux-style，目前够清晰。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> counterReducer = (count, action) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">  <span class="keyword">case</span> INCREMENT:</span><br><span class="line">    <span class="keyword">return</span> count + <span class="number">1</span></span><br><span class="line">  <span class="keyword">case</span> DECREMENT:</span><br><span class="line">    <span class="keyword">return</span> count - <span class="number">1</span></span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Counter = withReducer(</span><br><span class="line">  <span class="string">'counter'</span>, <span class="string">'dispatch'</span>, counterReducer, <span class="number">0</span></span><br><span class="line">)((&#123; counter, dispatch &#125;) =&gt; (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">      Count: &#123;counter&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="title">button</span> <span class="attribute">onClick</span>=<span class="value">&#123;()</span> =&gt;</span> dispatch(&#123; type: INCREMENT &#125;)&#125;&gt;Increment<span class="tag">&lt;/<span class="title">button</span>&gt;</span> /&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="title">button</span> <span class="attribute">onClick</span>=<span class="value">&#123;()</span> =&gt;</span> dispatch(&#123; type: DECREMENT &#125;)&#125;&gt;Decrement<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  )</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="u6027_u80FD"><a href="#u6027_u80FD" class="headerlink" title="性能"></a>性能</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A component that is expensive to render</span></span><br><span class="line"><span class="keyword">const</span> ExpensiveComponent = (&#123; propA, propB &#125;) =&gt; &#123;...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Optimized version of same component, using shallow comparison of props</span></span><br><span class="line"><span class="comment">// Same effect as React's PureRenderMixin</span></span><br><span class="line"><span class="keyword">const</span> OptimizedComponent = pure(ExpensiveComponent)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Even more optimized: only updates if specific prop keys have changed</span></span><br><span class="line"><span class="keyword">const</span> HyperOptimizedComponent = onlyUpdateForKeys([<span class="string">'propA'</span>, <span class="string">'propB'</span>])(ExpensiveComponent)</span><br></pre></td></tr></table></figure>
<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="Pattern"><a href="#Pattern" class="headerlink" title="Pattern"></a>Pattern</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EnhancedComponent = hoc(BaseComponent)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> composedHoc = compose(hoc1, hoc2, hoc3)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Same as</span></span><br><span class="line"><span class="keyword">const</span> composedHoc = BaseComponent =&gt; hoc1(hoc2(hoc3(BaseComponent)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// Same as</span></span><br><span class="line">@withState(<span class="comment">/*...args*/</span>)</span><br><span class="line">@mapProps(<span class="comment">/*...args*/</span>)</span><br><span class="line">@pure</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Component</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>## </p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><h2 id="u6570_u636E_u6D41"><a href="#u6570_u636E_u6D4]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[ECSS Reading Notes]]></title>
    <link href="http://shane.hsi.rocks/2016/04/18/ECSS-Reading-Notes/"/>
    <id>http://shane.hsi.rocks/2016/04/18/ECSS-Reading-Notes/</id>
    <published>2016-04-18T05:30:12.000Z</published>
    <updated>2016-04-18T06:39:07.000Z</updated>
    <content type="html"><![CDATA[<h1 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h1><p>会有一些可选的关于 tools 的 guidelines。</p>
<h1 id="u7B2C_u4E00_u7AE0"><a href="#u7B2C_u4E00_u7AE0" class="headerlink" title="第一章"></a>第一章</h1><p>定义下问题。</p>
<p>定义下基本需求：</p>
<ul>
<li>大型 css base，可维护</li>
<li>可安全删除某些 portion</li>
<li>能快速跟上新的设计</li>
<li>改变不影响其他</li>
<li>工具少，工作流简单</li>
<li>aria 来做 state change communication</li>
</ul>
<p>今晚阅读完毕。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h1><p>会有一些可选的关于 tools 的 guidelines。</p>
<h1 id="u7B2C_u4E0]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Test mock terminology]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Test-mock-terminology/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Test-mock-terminology/</id>
    <published>2016-04-16T08:45:55.000Z</published>
    <updated>2016-04-16T09:00:29.000Z</updated>
    <content type="html"><![CDATA[<p><a href="http://sinonjs.org/#examples" target="_blank" rel="external">sinon examples</a> 非常的清晰。</p>
<p>找到一篇中文：<a href="http://www.tuicool.com/articles/iAz6fi" target="_blank" rel="external">置换测试: Mock, Stub 和其他</a></p>
<ul>
<li><p>double - 理解为置换，它是所有模拟测试对象的 <strong>统称</strong>，我们也可以称它为替身。</p>
</li>
<li><p>stub - 测试桩，它能实现当特定的方法被调用时，返回一个指定的模拟值（每次一致的模拟数据）。</p>
</li>
</ul>
<p>以 sinon.js 为例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stub = sinon.stub().returns(<span class="number">42</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>spy - 侦查，它负责汇报情况，持续追踪什么方法 <strong>被调用了</strong> ，以及调用过程中 <strong>传递了哪些参数</strong> 。比如一个特定的方法是否被调用或者是否使用正确的参数调用。当你需要测试两个对象间的 某些<strong>协议</strong> 或者关系时会非常有用。</li>
</ul>
<blockquote>
<p>关键是方法间的 <strong>协议</strong>。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">it(<span class="string">"calls the original function"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> spy = sinon.spy();</span><br><span class="line">    <span class="keyword">var</span> proxy = once(spy);</span><br><span class="line"></span><br><span class="line">    proxy();</span><br><span class="line"></span><br><span class="line">    assert(spy.called);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>mock - 与 spy 类似，有些许不同。 spy 追踪所有的方法调用，并在事后让你写断言，而 mock 通常需要你 <strong>事先设定期望</strong>。你告诉它你期望发生什么，然后执行测试代码并验证最后的结果与事先定义的期望是否一致。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">it(<span class="string">"returns the return value from the original function"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> myAPI = &#123; method: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125; &#125;;</span><br><span class="line">    <span class="keyword">var</span> mock = sinon.mock(myAPI);</span><br><span class="line">    mock.expects(<span class="string">"method"</span>).once().returns(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> proxy = once(myAPI.method);</span><br><span class="line"></span><br><span class="line">    assert.equals(proxy(), <span class="number">42</span>);</span><br><span class="line">    mock.verify();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>fake - <strong>具备完整</strong> 功能实现和行为的对象，行为上来说它和这个类型的真实对象上一样，但不同于它所模拟的类，它使测试变得更加容易。一个典型的例子是使用内存中的数据库来生成一个数据持久化对象，而不是去访问一个真正的生产环境的数据库。</li>
</ul>
<p>对细节有更多，参考 <a href="http://martinfowler.com/articles/mocksArentStubs.html" target="_blank" rel="external">Mocks Aren’t Stubs</a></p>
<h2 id="u6A21_u62DF_u4E3B_u4E49_u8005__28Mockists_29_vs-__u7EDF_u8BA1_u4E3B_u4E49_u8005__28Statists_29"><a href="#u6A21_u62DF_u4E3B_u4E49_u8005__28Mockists_29_vs-__u7EDF_u8BA1_u4E3B_u4E49_u8005__28Statists_29" class="headerlink" title="模拟主义者 (Mockists) vs. 统计主义者 (Statists)"></a>模拟主义者 (Mockists) vs. 统计主义者 (Statists)</h2><p>总结下，模拟的是行为（内部的），统计的是最终状态。</p>
<p>许多关于模拟对象的讨论主要是衍生自 Fowler 的文章的，它们讨论了两种不同类型的程序员，模拟主义者和统计主义者，所写的测试。</p>
<p>模拟主意的方式是测试对象之间的交互。通过使用模拟对象，你可以更容易地验证被测对象是否遵循了它与其他类已建立的协议，使得在正确的时间发生正确的外部调用。对于那些使用行为驱动 (behavior-driven) 的开发者来说，这种测试可以驱动出更好的生产代码，因为你需要明确模拟出特定的方法，这可以帮你设计出在两个对象之间使用的更优雅的API，这种想法与模拟驱动紧密联系在一起。因此模拟主义的测试更偏向于单元级别的测试，而不是完全的端到端 (end-to-end) 测试。</p>
<p>统计主义的方式是不使用模拟对象。这种思路是测试时只测试状态而不是行为，因此这种类型的测试更加健壮。使用模拟测试时，如果你更新了实际类的行为，模拟类也需要同步更新；如果你忘了这么做，你可能会遇到测试可以通过但是代码却不能正确工作的情况。通过强调在测试环境中只使用那些真正的代码，统计主意的测试可以帮助你 <strong>减少测试代码和实现代码的耦合度，并降低出错率</strong>。这种类型的测试，您可能已经猜到，适合于更全面的端到端的测试。</p>
<p>当然，并不是说有两个对立的程序员学派；你不可能看到模拟主义和统计主义的当街对决。这种分歧是有用的，但是，得认识到 mock 在有些时候是你的工具箱里最好的工具，但是有时候又不是。不同类型的测试适用于不同的任务，并且最高效的测试套件往往是不同测试风格的集合体。仔细考虑你到底想要用单个测试来验证些什么，这能帮助你找到最合适的测试方式，而且能帮你决定对于当前工作来说，使用模拟测试对象是否是正确的工具。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="http://sinonjs.org/#examples" target="_blank" rel="external">sinon examples</a> 非常的清晰。</p>
<p>找到一篇中文：<a href="http://www.tuicool]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Wallaby Summary]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Wallaby-Summary/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Wallaby-Summary/</id>
    <published>2016-04-16T08:38:36.000Z</published>
    <updated>2016-04-16T08:45:25.000Z</updated>
    <content type="html"><![CDATA[<p>测试基础：</p>
<p>Mocha + expect(assertion) + sinon</p>
<ul>
<li><p>Node + TypeScript</p>
</li>
<li><p>Browser + webpack + TypeScript(to ES6) + Babel(ES7，主要是 async/await)</p>
</li>
<li><p>React tsx</p>
</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>测试基础：</p>
<p>Mocha + expect(assertion) + sinon</p>
<ul>
<li><p>Node + TypeScript</p>
</li>
<li><p>Browser + webpack + TypeScript(to ES6) ]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Wallaby.js TypeScript Node Browser]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Wallaby-js-TypeScript-Node-Browser/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Wallaby-js-TypeScript-Node-Browser/</id>
    <published>2016-04-16T08:20:07.000Z</published>
    <updated>2016-04-16T08:34:27.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u7ED3_u5408_webpack__u7684"><a href="#u7ED3_u5408_webpack__u7684" class="headerlink" title="结合 webpack 的"></a>结合 webpack 的</h2><p>用到了 wallaby-webpack postprocessor 和 TypeScript。</p>
<p>package.json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"chai"</span>: <span class="string">"^2.1.2"</span>,</span><br><span class="line">    <span class="string">"wallaby-webpack"</span>: <span class="string">"*"</span>,</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^1.7.3"</span>,</span><br><span class="line">    <span class="string">"ts-loader"</span>: <span class="string">"^0.5.5"</span>,</span><br><span class="line">    <span class="string">"typescript"</span>: <span class="string">"*"</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>tsconfig.json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="string">"module"</span>: <span class="string">"commonjs"</span>,</span><br><span class="line">    <span class="string">"target"</span>: <span class="string">"es5"</span>,</span><br><span class="line">    <span class="string">"noEmit"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"exclude"</span>: [</span><br><span class="line">    <span class="string">"node_modules"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"files"</span>: [</span><br><span class="line">    <span class="string">"typings/tsd.d.ts"</span>,</span><br><span class="line">    <span class="string">"typings/assertion-error/assertion-error.d.ts"</span>,</span><br><span class="line">    <span class="string">"typings/chai/chai.d.ts"</span>,</span><br><span class="line">    <span class="string">"typings/jasmine/jasmine.d.ts"</span>,</span><br><span class="line">    <span class="string">"typings/node/node.d.ts"</span>,</span><br><span class="line">    <span class="string">"test/personSpec.ts"</span>,</span><br><span class="line">    <span class="string">"src/Person.ts"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>wallaby.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> wallabyWebpack = <span class="built_in">require</span>(<span class="string">'wallaby-webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> webpackPostprocessor = wallabyWebpack(&#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="comment">// load 为 false，是因为用到了 webpack。</span></span><br><span class="line">      &#123; pattern: <span class="string">'src/**/*.ts'</span>, load: <span class="literal">false</span> &#125;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      &#123; pattern: <span class="string">'test/**/*Spec.ts'</span>, load: <span class="literal">false</span> &#125;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 结合 webpack</span></span><br><span class="line">    postprocessor: webpackPostprocessor,</span><br><span class="line"></span><br><span class="line">    bootstrap: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// required to trigger test loading</span></span><br><span class="line">      <span class="built_in">window</span>.__moduleBundler.loadTests();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="u7EAF_TypeScript"><a href="#u7EAF_TypeScript" class="headerlink" title="纯 TypeScript"></a>纯 TypeScript</h2><p>安装下 jasmine 的 typings</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">w</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="string">'src/*Browser.ts'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/*BrowserSpec.ts'</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后是这么引用 Jasmine 的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///&lt;reference path="../typings/jasmine/jasmine.d.ts"/&gt;</span></span><br><span class="line"><span class="comment">///&lt;reference path="../src/sayingsBrowser.ts"/&gt;</span></span><br><span class="line"></span><br><span class="line">describe(<span class="string">'Sayings Greeter'</span>, () =&gt; &#123;</span><br><span class="line">    it(<span class="string">'should greet'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="keyword">var</span> greeter = <span class="keyword">new</span> Sayings.Greeter(<span class="string">'John'</span>);</span><br><span class="line">        expect(greeter.greet()).toBe(<span class="string">'Hello, John'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>纯的 TypeScript。基本没啥这么写的。要么就用 webpack 来写。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">w</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="string">'src/*Node.ts'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/*NodeSpec.ts'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    env: &#123;</span><br><span class="line">      type: <span class="string">'node'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// you may remove the setting if you have a tsconfig.json file where the same is set</span></span><br><span class="line">    compilers: &#123;</span><br><span class="line">      <span class="string">'**/*.ts'</span>: w.compilers.typeScript(&#123;<span class="built_in">module</span>: <span class="string">'commonjs'</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// By default TypeScript compiler renames .ts files to .js files.</span></span><br><span class="line">    <span class="comment">// If you'd like to not do it and for example use your own renaming strategy,</span></span><br><span class="line">    <span class="comment">// you may pass 'noRename' option to TS compiler</span></span><br><span class="line">    <span class="comment">//  '**/*.ts': w.compilers.typeScript(&#123; noRename: true &#125;)</span></span><br><span class="line">    <span class="comment">// and may use preprocessors to rename files the way you like:</span></span><br><span class="line">    <span class="comment">//preprocessors: &#123;</span></span><br><span class="line">    <span class="comment">//  '**/*.ts': file =&gt; file.rename(file.path + '.js').content</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u7ED3_u5408_webpack__u7684"><a href="#u7ED3_u5408_webpack__u7684" class="headerlink" title="结合 webpack 的"></a>结合 webpack 的</h2><p>用到]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[JavaScript existential operator alternative syntax]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/JavaScript-existential-operator-alternative-syntax/"/>
    <id>http://shane.hsi.rocks/2016/04/16/JavaScript-existential-operator-alternative-syntax/</id>
    <published>2016-04-16T08:05:06.000Z</published>
    <updated>2016-04-16T08:06:57.000Z</updated>
    <content type="html"><![CDATA[<p><a href="http://stackoverflow.com/questions/15260732/does-typescript-support-the-operator-and-whats-it-called" target="_blank" rel="external">链接</a></p>
<p>妥协的方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> thing = foo &amp;&amp; foo.bar || <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> thing = foo &amp;&amp; foo.bar &amp;&amp; foo.bar.check &amp;&amp; foo.bar.check.x || <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="http://stackoverflow.com/questions/15260732/does-typescript-support-the-operator-and-whats-it-called" target="_blank" rel="exter]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Wallaby.js Configuration file]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Wallaby-js-Configuration-file/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Wallaby-js-Configuration-file/</id>
    <published>2016-04-16T05:00:01.000Z</published>
    <updated>2016-04-16T08:15:14.000Z</updated>
    <content type="html"><![CDATA[<p>by default, wallaby.js is using PhantomJs to run tests.</p>
<p>默认是在 PhantomJs 跑测试（就是 browsers 啦）。</p>
<p>通过 <code>env</code> 来跑在 node 或者 <a href="https://wallabyjs.com/docs/integration/electron.html" target="_blank" rel="external">latest Chromium/V8 via Electron</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">env: &#123;</span><br><span class="line">  type: <span class="string">'node'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> env: &#123;</span><br><span class="line">  kind: <span class="string">'electron'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wallaby</span><br><span class="line">    .localProjectDir <span class="comment">// string 返回 project 当前的目录 </span></span><br><span class="line">    .projectCacheDir <span class="comment">// string project 的 cache 目录 也就是， wallaby 会把文件从 `files` `tests` 复制到 cache 目录，跑的是 cache 里的</span></span><br><span class="line">    .compilers <span class="comment">// 访问 TypeScript Babel compilers https://wallabyjs.com/docs/config/compilers.html</span></span><br><span class="line">    .defaults</span><br></pre></td></tr></table></figure>
<h2 id="u5FEB_u6377_u94FE_u63A5"><a href="#u5FEB_u6377_u94FE_u63A5" class="headerlink" title="快捷链接"></a>快捷链接</h2><ul>
<li><p>配置 compilers <a href="https://wallabyjs.com/docs/integration/typescript.html" target="_blank" rel="external">TypeScript</a> 和 <a href="https://wallabyjs.com/docs/integration/es-next.html" target="_blank" rel="external">ES6/ES7</a></p>
</li>
<li><p>配置 test framework 跑 test 之前设置下环境 <a href="https://wallabyjs.com/docs/config/bootstrap.html" target="_blank" rel="external">setup/bootstrap</a></p>
</li>
<li><p>配置 <a href="https://wallabyjs.com/docs/config/runner.html" target="_blank" rel="external">env</a>，node.js 其他 version 的 phantomjs，electron。</p>
</li>
<li><p><a href="https://wallabyjs.com/docs/config/preprocessors.html" target="_blank" rel="external">preprocessor</a>，比如处理某些 template 为 javascript 来 load tests</p>
</li>
</ul>
<h2 id="test_framework"><a href="#test_framework" class="headerlink" title="test framework"></a>test framework</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">wallaby</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="string">'src/**/*.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/**/*Spec.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    testFramework: <span class="string">'mocha'</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="delays"><a href="#delays" class="headerlink" title="delays"></a>delays</h2><p>使用默认的</p>
<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p>输出详细信息，一般不用，报 bug 的时候可以用。</p>
<h1 id="Files_and_tests"><a href="#Files_and_tests" class="headerlink" title="Files and tests"></a>Files and tests</h1><h2 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h2><p>注意：</p>
<ul>
<li>一定要写全<ul>
<li>比如如果你在 js 里 load 了 json，要写上</li>
<li>如果你 require 了其他的 js，要写上</li>
<li>例外<ul>
<li>node_modules 目录（因为 wallaby 不会 cache 它们，就用 local 的）</li>
<li>如果用了 webpack 等 bundler（除非用的是 global）</li>
<li>用了 中间件 <a href="https://wallabyjs.com/docs/config/middleware.html" target="_blank" rel="external">Middleware</a>???</li>
</ul>
</li>
</ul>
</li>
<li>注意根据依赖设置前后顺序</li>
<li>可以是 js，也可以是 css， image json 等任何类型</li>
</ul>
<h2 id="Tests"><a href="#Tests" class="headerlink" title="Tests"></a>Tests</h2><p>略过</p>
<h2 id="File_object"><a href="#File_object" class="headerlink" title="File object"></a>File object</h2><p>pattern</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">files: [</span><br><span class="line">      <span class="string">'src/**/*.js'</span>,</span><br><span class="line">      <span class="comment">// is the same as</span></span><br><span class="line">      &#123; pattern: <span class="string">'src/**/*.js'</span>, instrument: <span class="literal">true</span>, load: <span class="literal">true</span>, ignore: <span class="literal">false</span> &#125;</span><br><span class="line">    ],</span><br></pre></td></tr></table></figure>
<p>其中 <code>ignore</code> 的快捷写法是 <code>!</code> 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"files"</span>: [</span><br><span class="line">    <span class="string">"src/**/*.js"</span>,</span><br><span class="line">    <span class="string">"!src/**/*Spec.js"</span></span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="string">"tests"</span>: [</span><br><span class="line">    <span class="string">"src/**/*Spec.js"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>load</code> 只是否被 sandbox HTML 加载（通过 <code>&lt;script&gt;</code> ）。如果用了 Webpack 就不需要了。</p>
<h2 id="Overriding_defaults"><a href="#Overriding_defaults" class="headerlink" title="Overriding defaults"></a>Overriding defaults</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">wallaby</span>) </span>&#123;</span><br><span class="line">  wallaby.defaults.files.instrument = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="string">'libs/lib1.js'</span>,</span><br><span class="line">      <span class="string">'libs/lib2.js'</span>,</span><br><span class="line">      <span class="string">'libs/lib3.js'</span>,</span><br><span class="line">      <span class="string">'libs/lib4.js'</span>,</span><br><span class="line">      &#123; pattern: <span class="string">'src/**/*.js'</span>, instrument: <span class="literal">true</span> &#125;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/**/*Spec.js'</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="Runner"><a href="#Runner" class="headerlink" title="Runner"></a>Runner</h1><p>PhantomJs, Chromium/V8 via Electron and node.js</p>
<p>默认的是 By default, PhantomJs (1.9.8)</p>
<p>具体的是细节，默认的和 node 就可以 </p>
<p><a href="https://wallabyjs.com/docs/config/runner.html" target="_blank" rel="external">更多</a></p>
<h1 id="Compilers"><a href="#Compilers" class="headerlink" title="Compilers"></a>Compilers</h1><p>这个和 preprocessors 会混淆。</p>
<p>preprocessors 也能 transform，然后给到 test runner，但是如果你要有 code coverage，首先 wallaby 需要在任意的 preprocessors 前，intstrument 它们。</p>
<p>也就是说 wallaby 需要了解这些 dialect。</p>
<p>Wallaby.js 本身就支持 ES6，JSX。其他的需要配置。</p>
<p>内置了三款：</p>
<blockquote>
<p>Wallaby.js has three built-in compilers: TypeScript, CoffeeScript and Babel.</p>
</blockquote>
<p>如果用了 Babel compiler ，就不要用 Babel preprocessor。</p>
<p>如果只用了 ES6，没用到 ES7，可以 keep using Babel preprocessor without Babel compiler。</p>
<p>但是如果用到了 TypeScript，则必须用 compiler。preprocessors for TypeScript and CoffeeScript are not required</p>
<p>连配置 compiler 的语法和 preprocessors 都差不多。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">compilers: &#123;</span><br><span class="line">  <span class="string">'**/*.js'</span>: wallaby.compilers.babel(&#123;</span><br><span class="line">    <span class="comment">// babel options</span></span><br><span class="line">    <span class="comment">// like `stage: n` for Babel 5.x or `presets: [...]` for Babel 6</span></span><br><span class="line">    <span class="comment">// (no need to duplicate .babelrc, if you have it, it'll be automatically loaded)</span></span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="string">'**/*.ts'</span>: wallaby.compilers.typeScript(&#123;</span><br><span class="line">    <span class="comment">// TypeScript compiler specific options</span></span><br><span class="line">    <span class="comment">// https://github.com/Microsoft/TypeScript/wiki/Compiler-Options</span></span><br><span class="line">    <span class="comment">// (no need to duplicate tsconfig.json, if you have it, it'll be automatically used)</span></span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Preprocessors"><a href="#Preprocessors" class="headerlink" title="Preprocessors"></a>Preprocessors</h2><p>我的需求已经不需要配置 Preprocessors 了。</p>
<p><a href="https://wallabyjs.com/docs/config/preprocessors.html" target="_blank" rel="external">链接</a></p>
<ul>
<li>compilers</li>
<li>instrumentation</li>
<li>preprocessors</li>
<li>postprocessor</li>
<li>test run</li>
</ul>
<p>It is not recommended to keep any state between function calls because preprocessors and compilers may run in different node processes.</p>
<p>Postprocessor is a function that runs for every batch of file changes after all compilers and preprocessors. It has access not to just one file, but to <strong>all</strong> files (compiled and preprocessed, as well as <strong>original ones</strong>). It is also guaranteed to always run in the <strong>same node process</strong>, so it can <strong>keep some required state</strong>.</p>
<p>Considering all of the above, postprocessor is an ideal place for something like a module bundler, or anything else that needs to  <strong>keep some state between</strong> test runs and have access to all files at the same time.</p>
<p>a function that takes a single argument and is supposed to return a <strong>promise</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> &#123;</span><br><span class="line">     files: [</span><br><span class="line">       <span class="string">'src/**/*.js'</span></span><br><span class="line">     ],</span><br><span class="line"></span><br><span class="line">     tests: [</span><br><span class="line">       <span class="string">'test/**/*Spec.js'</span></span><br><span class="line">     ],</span><br><span class="line"></span><br><span class="line">     <span class="comment">// @param wallaby wallaby.js context</span></span><br><span class="line">     postprocessor: <span class="function"><span class="keyword">function</span> (<span class="params">wallaby</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">         <span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="comment">// postprocessor work here</span></span><br><span class="line">              <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">              <span class="comment">// resolve when the work is done</span></span><br><span class="line">              <span class="comment">// or reject on errors</span></span><br><span class="line">              resolve();</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">              reject(err);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure>
<p>具体的可以看下 webpack 的示例</p>
<p><a href="https://github.com/jeffling/wallaby-webpack/blob/master/index.js" target="_blank" rel="external">wallaby-webpack/index.js</a></p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>setup，alias 是 bootstrap。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="string">'src/**/*.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/**/*Spec.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    setup: <span class="function"><span class="keyword">function</span> (<span class="params">wallaby</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// wallaby.testFramework is jasmine/QUnit/mocha object</span></span><br><span class="line">      wallaby.testFramework.ui(<span class="string">'tdd'</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// you can access 'window' object in a browser environment,</span></span><br><span class="line">      <span class="comment">// 'global' object or require(...) something in node environment 比如 window 和 global</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>by default, wallaby.js is using PhantomJs to run tests.</p>
<p>默认是在 PhantomJs 跑测试（就是 browsers 啦）。</p>
<p>通过 <code>env</code> 来跑在 node 或者 ]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Monorepo]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Monorepo/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Monorepo/</id>
    <published>2016-04-16T04:44:25.000Z</published>
    <updated>2016-04-16T04:44:41.000Z</updated>
    <content type="html"><![CDATA[<p><a href="https://github.com/babel/babel/blob/master/doc/design/monorepo.md" target="_blank" rel="external">Why is Babel a monorepo?</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="https://github.com/babel/babel/blob/master/doc/design/monorepo.md" target="_blank" rel="external">Why is Babel a monorepo?</a></]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Wallaby ES7]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Wallaby-ES7/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Wallaby-ES7/</id>
    <published>2016-04-16T04:28:53.000Z</published>
    <updated>2016-04-16T08:17:08.000Z</updated>
    <content type="html"><![CDATA[<p>先看看 package.json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.4.5"</span>,</span><br><span class="line">    <span class="string">"babel-polyfill"</span>: <span class="string">"^6.3.14"</span>,</span><br><span class="line">    <span class="string">"babel-preset-es2015"</span>: <span class="string">"^6.3.13"</span>,</span><br><span class="line">    <span class="string">"babel-preset-stage-0"</span>: <span class="string">"^6.3.13"</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中 babel-polyfill 上次用到过，对于支持 async/await 必须：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"dependencies"</span>: &#123;</span><br><span class="line">  <span class="string">"core-js"</span>: <span class="string">"^2.1.0"</span>,</span><br><span class="line">  <span class="string">"babel-regenerator-runtime"</span>: <span class="string">"^6.3.13"</span>,</span><br><span class="line">  <span class="string">"babel-runtime"</span>: <span class="string">"^5.0.0"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/zloirock/core-js" target="_blank" rel="external">core-js</a> 是一个 polyfills 集合。</p>
<p>具体参见：<a href="https://babeljs.io/docs/usage/polyfill/" target="_blank" rel="external">Polyfill</a></p>
<p>babel-polyfill 和 regenerator-runtime 差别不大。具体差别参考上面的链接和源码。</p>
<p>在看下 <code>.babelrc</code> 配置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [<span class="string">"es2015"</span>, <span class="string">"stage-0"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再看下 wallaby.js 配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">wallaby</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      &#123;pattern: <span class="string">'node_modules/babel-polyfill/dist/polyfill.js'</span>, instrument: <span class="literal">false</span>&#125;,</span><br><span class="line">      <span class="string">'src/**/*.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/**/*Spec.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    compilers: &#123;</span><br><span class="line">      <span class="string">'**/*.js'</span>: wallaby.compilers.babel()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>其中加入这句话，其中，<code>instrument</code> 为 <code>false</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;pattern: <span class="string">'node_modules/babel-polyfill/dist/polyfill.js'</span>, instrument: <span class="literal">false</span>&#125;,</span><br></pre></td></tr></table></figure>
<p>链接 <a href="https://wallabyjs.com/docs/config/files.html" target="_blank" rel="external">Configuration file: Files and tests</a></p>
<p>关于 <code>instrument</code>：</p>
<blockquote>
<p>The instrument boolean property (<strong>true by default</strong>) determines whether the file is instrumented. Setting the property to false disables the file <strong>code coverage reporting</strong> and prevents the file changes from <strong>triggering automatic test execution</strong>. The setting should normally be set to false for libraries, utils and other rarely changing files. Using the setting makes wallaby.js run your code <strong>faster</strong>, as it doesn’t have to perform unnecessary work.</p>
</blockquote>
<p>还有一个是 <code>compilers</code>。链接 <a href="https://wallabyjs.com/docs/config/compilers.html" target="_blank" rel="external">Compilers</a></p>
<p>写到这，我觉得要把 Wallaby/Configuration file 从头到尾看一遍。</p>
<p>更新：已经看完了。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>先看看 package.json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2<]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Babel Stage-x Syntax]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Babel-Stage-x-Syntax/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Babel-Stage-x-Syntax/</id>
    <published>2016-04-16T04:14:01.000Z</published>
    <updated>2016-04-16T04:28:04.000Z</updated>
    <content type="html"><![CDATA[<h1 id="stage_0"><a href="#stage_0" class="headerlink" title="stage 0"></a>stage 0</h1><p><a href="https://github.com/tc39/ecma262/blob/master/stage0.md" target="_blank" rel="external">stage0</a></p>
<h2 id="Function_Bind_Syntax"><a href="#Function_Bind_Syntax" class="headerlink" title="Function Bind Syntax"></a>Function Bind Syntax</h2><p>文章 <a href="https://babeljs.io/blog/2015/05/14/function-bind" target="_blank" rel="external">Function Bind Syntax</a>.</p>
<h1 id="stage_1"><a href="#stage_1" class="headerlink" title="stage 1"></a>stage 1</h1><p>和 TypeScript 类似，使用 TypeScript 语法即可。</p>
<h1 id="stage_2"><a href="#stage_2" class="headerlink" title="stage 2"></a>stage 2</h1><h2 id="es-trailing-function-commas"><a href="#es-trailing-function-commas" class="headerlink" title="es-trailing-function-commas"></a><a href="https://github.com/jeffmo/es-trailing-function-commas" target="_blank" rel="external">es-trailing-function-commas</a></h2><p>这个倒还好。</p>
<h2 id="ecmascript-rest-spread"><a href="#ecmascript-rest-spread" class="headerlink" title="ecmascript-rest-spread"></a><a href="https://github.com/sebmarkbage/ecmascript-rest-spread" target="_blank" rel="external">ecmascript-rest-spread</a></h2><p>1 Rest Properties</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = &#123; x: <span class="number">1</span>, y: <span class="number">2</span>, a: <span class="number">3</span>, b: <span class="number">4</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>2 Spread Properties</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n = &#123; x, y, ...z &#125;;</span><br><span class="line">n; <span class="comment">// &#123; x: 1, y: 2, a: 3, b: 4 &#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="stage_3"><a href="#stage_3" class="headerlink" title="stage 3"></a>stage 3</h1><h2 id="Async_to_generator_transform"><a href="#Async_to_generator_transform" class="headerlink" title="Async to generator transform"></a>Async to generator transform</h2><p>In</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">await</span> bar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Out</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _asyncToGenerator = <span class="function"><span class="keyword">function</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> foo = _asyncToGenerator(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> bar();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>todo 深入理解 async/await yield promise</p>
</blockquote>
<h2 id="exponentiation-operator"><a href="#exponentiation-operator" class="headerlink" title="exponentiation-operator"></a><a href="https://github.com/rwaldron/exponentiation-operator" target="_blank" rel="external">exponentiation-operator</a></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x ** y</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> squared = <span class="number">2</span> ** <span class="number">2</span>;</span><br><span class="line"><span class="comment">// same as: 2 * 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cubed = <span class="number">2</span> ** <span class="number">3</span>;</span><br><span class="line"><span class="comment">// same as: 2 * 2 * 2</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="stage_0"><a href="#stage_0" class="headerlink" title="stage 0"></a>stage 0</h1><p><a href="https://github.com/tc39/ecma262/blob/mast]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Wallaby node]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Wallaby-node/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Wallaby-node/</id>
    <published>2016-04-16T04:03:55.000Z</published>
    <updated>2016-04-16T04:37:56.000Z</updated>
    <content type="html"><![CDATA[<p><a href="https://github.com/shanehsi/wallaby-node-iojs-sample" target="_blank" rel="external">demo</a></p>
<p>先看 package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "<span class="attribute">private</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">  "<span class="attribute">devDependencies</span>": <span class="value">&#123;</span><br><span class="line">    "<span class="attribute">chai</span>": <span class="value"><span class="string">"^3.5.0"</span></span><br><span class="line">  </span>&#125;</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
<p>用了 chai 这个 assertion library。</p>
<p>在看 wallaby.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    files: [</span><br><span class="line">      <span class="string">'lib/**/*.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    tests: [</span><br><span class="line">      <span class="string">'test/**/*Spec.js'</span></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    bootstrap: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      global.expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    env: &#123;</span><br><span class="line">      type: <span class="string">'node'</span></span><br><span class="line">      <span class="comment">// More options are described here</span></span><br><span class="line">      <span class="comment">// http://wallabyjs.com/docs/integration/node.html</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>解释下： bootstrap，顾名思义，就是在 bootstrap 是，重新将 expect 全局变量替换下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bootstrap: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  global.expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>更多的<a href="http://wallabyjs.com/docs/integration/node.html" target="_blank" rel="external">配置</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="https://github.com/shanehsi/wallaby-node-iojs-sample" target="_blank" rel="external">demo</a></p>
<p>先看 package.json</p>
<figure]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Wallaby Intro]]></title>
    <link href="http://shane.hsi.rocks/2016/04/16/Wallaby-Intro/"/>
    <id>http://shane.hsi.rocks/2016/04/16/Wallaby-Intro/</id>
    <published>2016-04-16T04:02:06.000Z</published>
    <updated>2016-04-16T04:02:14.000Z</updated>
    <content type="html"><![CDATA[<h1 id="u4ECB_u7ECD_Wallaby-js"><a href="#u4ECB_u7ECD_Wallaby-js" class="headerlink" title="介绍 Wallaby.js"></a>介绍 Wallaby.js</h1><h2 id="What_about_a_list_of_main_features_3F"><a href="#What_about_a_list_of_main_features_3F" class="headerlink" title="What about a list of main features?"></a>What about a list of main features?</h2><ul>
<li>continuous testing 持续测试，性能不错</li>
<li>browser code unit testing，测试 browser，是依赖（PhantomJs, Electron or node.js）</li>
<li>node.js unit testing</li>
<li>Supports many testing frameworks（Jasmine 默认）</li>
<li>支持 ES6 and React JSX</li>
<li>支持 TypeScript, CoffeeScript, and ES7</li>
<li>支持  Webpack and Browserify</li>
</ul>
<p>其他的包括：</p>
<ul>
<li>可扩展 preprocessors, compilers and more</li>
<li>性能（只跑变动的，并行的跑，跑选择的）</li>
<li>实时覆盖率</li>
<li>在编辑器 inline 显示 expectations, errors and console.log messages</li>
<li>显示跑的 test 的变量的 data</li>
<li>test 执行的截图？？</li>
</ul>
<h2 id="u548C_Karma_2C_Mocha__u7684_u533A_u522B"><a href="#u548C_Karma_2C_Mocha__u7684_u533A_u522B" class="headerlink" title="和 Karma, Mocha 的区别"></a>和 Karma, Mocha 的区别</h2><p>其他的 runner，需要手动跑，配置 watch，跑所有的 tests，test 的结果是显示在其他的地方，需要切换。</p>
<h2 id="u6587_u7AE0_u94FE_u63A5"><a href="#u6587_u7AE0_u94FE_u63A5" class="headerlink" title="文章链接"></a>文章链接</h2><ul>
<li>所有文档 <a href="http://wallabyjs.com/docs/" target="_blank" rel="external">地址</a></li>
<li>切换不同的 test framework <a href="https://wallabyjs.com/docs/integration/overview.html#supported-testing-frameworks" target="_blank" rel="external">favorite testing framework</a>，主要考虑到如何测试 async/await, promise, observable 这些。Jasmine 似乎不够强大。选择更通用的 mocha 吧。Jasmine 的文档写的也是一绝（不好读）。mocha 肯定有解决 async/await 的方法。社区支持很好。</li>
</ul>
<p>默认的 test framework：</p>
<blockquote>
<p>By default, wallaby.js is using jasmine for browser and mocha for node.</p>
</blockquote>
<p>Todo list:</p>
<ul>
<li><p>[ ]  wallaby</p>
<ul>
<li><p>[ ] webpack</p>
</li>
<li><p>[ ] typescript</p>
</li>
<li><p>[ ] mocha</p>
</li>
<li><p>[ ] async/await</p>
</li>
<li><p>[ ] promise</p>
</li>
<li><p>[ ] rx observable</p>
</li>
<li><p>[ ] node (express)</p>
</li>
</ul>
</li>
<li><p>[ ] koa 2</p>
<ul>
<li>[ ] wallaby</li>
</ul>
</li>
<li><p>测试 React，如何集成 tsx？</p>
</li>
<li>测试 node <a href="https://wallabyjs.com/docs/integration/node.html" target="_blank" rel="external">Node.js</a>，特别是 typescript。</li>
<li><a href="https://wallabyjs.com/docs/integration/typescript.html" target="_blank" rel="external">测试 TypeScript</a></li>
<li><a href="https://wallabyjs.com/docs/integration/es-next.html" target="_blank" rel="external">集成 Babel</a></li>
<li><a href="https://wallabyjs.com/docs/integration/webpack.html" target="_blank" rel="external">集成 webpack</a></li>
<li><a href="https://wallabyjs.com/docs/config/preprocessors.html" target="_blank" rel="external">支持 preprocessors</a></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4ECB_u7ECD_Wallaby-js"><a href="#u4ECB_u7ECD_Wallaby-js" class="headerlink" title="介绍 Wallaby.js"></a>介绍 Wallaby.js</h1><h2 id="Wha]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Spring IoC有什么好处呢？]]></title>
    <link href="http://shane.hsi.rocks/2016/04/01/What-s-the-Benefis-of-IoC/"/>
    <id>http://shane.hsi.rocks/2016/04/01/What-s-the-Benefis-of-IoC/</id>
    <published>2016-04-01T05:41:10.000Z</published>
    <updated>2016-04-01T05:46:16.000Z</updated>
    <content type="html"><![CDATA[<p><a href="https://www.zhihu.com/question/23277575" target="_blank" rel="external">原文链接</a></p>
<p>私以为以上各位都没有对spring ioc的精髓讲解到位。大多都在很模糊的说是什么，抽象化的表述或者含糊其辞的说概念。</p>
<p>ioc的思想最核心的地方在于，资源不由使用资源的双方管理，而由 <strong>不使用资源的第三方管理</strong> ，这可以带来很多好处。第一，资源集中管理，实现 <strong>资源的可配置和易管理</strong> 。第二，降低了使用资源双方的依赖程度，也就是我们说的耦合度。</p>
<p>也就是说，甲方要达成某种目的不需要直接依赖乙方，它只需要达到的目的告诉第三方机构就可以了，比如甲方需要一双袜子，而乙方它卖一双袜子，它要把袜子卖出去，并不需要自己去直接找到一个卖家来完成袜子的卖出。它也只需要找第三方，告诉别人我要卖一双袜子。这下好了，甲乙双方进行交易活动，都不需要自己直接去找卖家，相当于程序内部开放接口，卖家由第三方作为参数传入。甲乙互相不依赖，而且只有在进行交易活动的时候，甲才和乙产生联系。反之亦然。这样做什么好处么呢，甲乙可以在对方不真实存在的情况下独立存在，而且保证不交易时候无联系，想交易的时候可以很容易的产生联系。甲乙交易活动不需要双方见面，避免了双方的互不信任造成交易失败的问题。因为交易由第三方来负责联系，而且甲乙都认为第三方可靠。那么交易就能很可靠很灵活的产生和进行了。</p>
<p>这就是ioc的核心思想。生活中这种例子比比皆是，支付宝在整个淘宝体系里就是庞大的ioc容器，交易双方之外的第三方，提供可靠性可依赖可灵活变更交易方的资源管理中心。另外人事代理也是，雇佣机构和个人之外的第三方。嗯，就这样，希望对题主有帮助。</p>
<p>==========================update===========================<br>在以上的描述中，诞生了两个专业词汇，依赖注入和控制反转<br>所谓的依赖注入，则是，甲方开放接口，在它需要的时候，能够讲乙方传递进来(注入)<br>所谓的控制反转，甲乙双方不相互依赖，交易活动的进行不依赖于甲乙任何一方，整个活动的进行由第三方负责管理。</p>
<p>这就是spring IOC的思想所在，不要只谈DI IOC这些概念。</p>
<p>人之所恶在好为人师,不实知，谨慎言。</p>
<p>作者：OneNoodle<br>链接：<a href="https://www.zhihu.com/question/23277575/answer/24259844" target="_blank" rel="external">https://www.zhihu.com/question/23277575/answer/24259844</a><br>来源：知乎<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="https://www.zhihu.com/question/23277575" target="_blank" rel="external">原文链接</a></p>
<p>私以为以上各位都没有对spring ioc的精髓讲解到位。大多都在很模糊的说是什]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[TypeScript typings]]></title>
    <link href="http://shane.hsi.rocks/2016/03/30/TypeScript-typings/"/>
    <id>http://shane.hsi.rocks/2016/03/30/TypeScript-typings/</id>
    <published>2016-03-30T03:57:29.000Z</published>
    <updated>2016-03-30T03:58:03.000Z</updated>
    <content type="html"><![CDATA[<p><a href="http://stackoverflow.com/questions/35919693/typescript-cannot-find-name-ipromise-in-rxjs-definition" target="_blank" rel="external">TypeScript cannot find name IPromise in RxJS definition</a></p>
<p>The RxJS type definition from DefinitelyTyped does appear to be outdated. Instead, use the type definition provided by the npm package.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typings install --save --ambient npm:rx/ts/rx<span class="class">.all</span><span class="class">.d</span><span class="class">.ts</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="http://stackoverflow.com/questions/35919693/typescript-cannot-find-name-ipromise-in-rxjs-definition" target="_blank" rel="extern]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[ES7 Decorator 与函数变换]]></title>
    <link href="http://shane.hsi.rocks/2016/03/29/ES7-Decorator-Function-Transform/"/>
    <id>http://shane.hsi.rocks/2016/03/29/ES7-Decorator-Function-Transform/</id>
    <published>2016-03-29T05:27:04.000Z</published>
    <updated>2016-03-30T14:31:46.000Z</updated>
    <content type="html"><![CDATA[<p>参考 <a href="https://mp.weixin.qq.com/s?__biz=MzA4NjE3MDg4OQ==&amp;mid=403162136&amp;idx=1&amp;sn=f0aeab0902d162bc98d8d8ad7ee54eea" target="_blank" rel="external">ES7 Decorator 与函数变换</a></p>
<p>这里面有很多的例子非常好。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mul</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concat</span>(<span class="params">arr1, arr2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr1.concat(arr2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在是 2 个数做 +，*，数组连接。</p>
<p>支持多位数，直接侵入式改写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add_many</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> args.reduce((a,b) =&gt; a+b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mul_many</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> args.reduce((a,b) =&gt; a*b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concat</span>(<span class="params">arr1, arr2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> args.reduce((a,b) =&gt; a.concat(b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更聪明的方法，抽出高阶函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (...args) =&gt; args.reduce(target);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> add_many = reducer(add);</span><br><span class="line"><span class="keyword">let</span> mul_many = reducer(mul);</span><br><span class="line"><span class="keyword">let</span> concat_many = reducer(concat);</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>参考 <a href="https://mp.weixin.qq.com/s?__biz=MzA4NjE3MDg4OQ==&amp;mid=403162136&amp;idx=1&amp;sn=f0aeab0902d162bc98d8d8ad7ee54eea" target]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[一直念着想着 CSS]]></title>
    <link href="http://shane.hsi.rocks/2016/03/27/Always-Thinking-about-CSS/"/>
    <id>http://shane.hsi.rocks/2016/03/27/Always-Thinking-about-CSS/</id>
    <published>2016-03-27T11:33:46.000Z</published>
    <updated>2016-03-28T02:14:33.000Z</updated>
    <content type="html"><![CDATA[<p>并不是不喜欢 CSS。而是找不到 CSS 的学习好方法。这东西就和学数学一样（原谅我用数学比较，因为我一直后悔没有多练习数学题），要大量的实践，总结规律，然后新的场景用总结的规律尝试去套，不能套的要去拓展和完善规律。</p>
<blockquote>
<p>哪一天我也能学好数学？O(∩_∩)O</p>
</blockquote>
<p>反正我不喜欢熟记一堆堆的理论然后找最佳实践，事实证明这样做真的好难好难。/(ㄒoㄒ)/~~</p>
<p>目前终于有了一个好的机会，在好的时间：</p>
<ul>
<li>做一个不是很复杂的 web app。</li>
<li>我脑海里已经有了一堆一堆的理论，什么 position relative/absolute，display inline-block/block。盒模型内部的目前觉得还好。</li>
</ul>
<h2 id="u6240_u6709_u7684_u603B_u7ED3"><a href="#u6240_u6709_u7684_u603B_u7ED3" class="headerlink" title="所有的总结"></a>所有的总结</h2><h3 id="u603B_u7ED3_2016_u5E7403_u670827_u65E519_3A50_3A38"><a href="#u603B_u7ED3_2016_u5E7403_u670827_u65E519_3A50_3A38" class="headerlink" title="总结 2016年03月27日19:50:38"></a>总结 2016年03月27日19:50:38</h3><p>关键还是要总结下原语。CSS 和 HTML 分开还是就使用 HTML（JSX）的名字做布局？分开的话，都是用 HTML 的话，就是有两类 Component。一类 layout。关键是这样写 Layout 可不可以重用。能重用的话，就完美了。</p>
<h3 id="u603B_u7ED3_2016_u5E7403_u670828_u65E510_3A07_3A53"><a href="#u603B_u7ED3_2016_u5E7403_u670828_u65E510_3A07_3A53" class="headerlink" title="总结 2016年03月28日10:07:53"></a>总结 2016年03月28日10:07:53</h3><h2 id="2016_u5E7403_u670828_u65E510_3A07_3A53"><a href="#2016_u5E7403_u670828_u65E510_3A07_3A53" class="headerlink" title="2016年03月28日10:07:53"></a>2016年03月28日10:07:53</h2><h3 id="u788E_u788E_u5FF5"><a href="#u788E_u788E_u5FF5" class="headerlink" title="碎碎念"></a>碎碎念</h3><p>margin 是可以重叠的，使用这个有风险。使用 margin 主要是为了隔开一些距离。其实只要一方隔开就行，可以选择 main part 设置 margin。</p>
<p>margin 和 padding 都可以隔开，建议在隔开这块，用 margin 多一点。画出的线条很漂亮（当然是因为 margin 隔着 border，而 padding 隔着的是看不见的字体周围的线条，从设计上也是 border 更有效）。</p>
<img src="/2016/03/27/Always-Thinking-about-CSS/1.png" alt="1.png" title="">
<h3 id="u603B_u7ED3"><a href="#u603B_u7ED3" class="headerlink" title="总结"></a>总结</h3><h2 id="2016_u5E7403_u670827_u65E519_3A50_3A38"><a href="#2016_u5E7403_u670827_u65E519_3A50_3A38" class="headerlink" title="2016年03月27日19:50:38"></a>2016年03月27日19:50:38</h2><h3 id="u60F3_u5230_u7684"><a href="#u60F3_u5230_u7684" class="headerlink" title="想到的"></a>想到的</h3><p>现在第一个要解决的是大的布局问题。这个用 position 可以很好的解决。</p>
<p>absolute 做大的布局的摆布。</p>
<p>relative 其实是做定位的时候，借用下其他元素的容量。这个看起来好难好难。但用的时候真的必须要。比如下面说到的同一行布局。</p>
<p>但是其实 relative 更多的是做些一些位移。要深刻理解 relative，应该比较下 relative/static。</p>
<p>参考：<a href="http://stackoverflow.com/questions/5011211/difference-between-static-and-relative-positioning" target="_blank" rel="external">Difference between static and relative positioning</a>。</p>
<p><strong>Statically positioned elements don’t obey <code>left</code>, <code>top</code>, <code>right</code> and <code>bottom</code> rules:</strong>。就酱，static 不会相对于自己的 normal position 位移。</p>
<p>如果有这样的需求就是 relative。</p>
<p>然而 absolute 都不用考虑 sibling，只要考虑 parent（为了方便定位，找一个好的 parent，^_^）。</p>
<p>同行摆布使用 <code>inline-block</code>，加上 <code>vertial-align: top</code>。参考：<a href="http://stackoverflow.com/questions/9273016/why-is-this-inline-block-element-pushed-downward" target="_blank" rel="external">Why is this inline-block element pushed downward?</a></p>
<p><code>inline-block</code> 是来替换 float（部分场景下，即放在同一行，但是如果真有一部分按左对齐，一部分按右对齐，还是得要 float），以及模拟 <code>table-cell</code> 这个（或者也可能是 ul li，突然发现，语义化元素的自带样式会和 css 有部分功能的重叠）。</p>
<p>参考：<a href="http://www.zhangxinxu.com/wordpress/2010/11/%E6%8B%9C%E6%8B%9C%E4%BA%86%E6%B5%AE%E5%8A%A8%E5%B8%83%E5%B1%80-%E5%9F%BA%E4%BA%8Edisplayinline-block%E7%9A%84%E5%88%97%E8%A1%A8%E5%B8%83%E5%B1%80/" target="_blank" rel="external">拜拜了,浮动布局-基于display:inline-block的列表布局</a>。这里重点说下 <code>line-height</code> 方法。</p>
<p>我还要解决一个问题，<strong>垂直居中问题</strong>。</p>
<p>一般是设置，<code>height</code> 和 <code>line-height</code>（这个是 wrapper） 相同，而且 <code>line-height</code> 要大于 <code>font-size</code>（一般也是这样）。<strong>而且只适用于单行文字</strong>。</p>
<blockquote>
<p>By default equal space will be given above and below the text and so the text will sit in the vertical center.</p>
</blockquote>
<p>其他几种方法是：</p>
<p><code>Vertical-Align</code> 是最简单的方法。但是它只适用于 <code>table-cell</code> 和一些 <code>inline</code>（估计 <code>inline-block</code> 不行）。也就是不适用于 block 元素。</p>
<p>网上关于垂直居中的文章特别多：比如这篇 <a href="http://vanseodesign.com/css/vertical-centering/" target="_blank" rel="external">6 Methods For Vertical Centering With CSS</a></p>
<p>我觉得其他的方法就研究 [lost] 吧（复杂的场景）。</p>
<h3 id="u603B_u7ED3-1"><a href="#u603B_u7ED3-1" class="headerlink" title="总结"></a>总结</h3><p>关键还是要总结下原语。CSS 和 HTML 分开还是就使用 HTML（JSX）的名字做布局？分开的话，都是用 HTML 的话，就是有两类 Component。一类 layout。关键是这样写 Layout 可不可以重用。能重用的话，就完美了。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>并不是不喜欢 CSS。而是找不到 CSS 的学习好方法。这东西就和学数学一样（原谅我用数学比较，因为我一直后悔没有多练习数学题），要大量的实践，总结规律，然后新的场景用总结的规律尝试去套，不能套的要去拓展和完善规律。</p>
<blockquote>
<p>哪一天我也能学好]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Why is this inline-block element pushed downward?]]></title>
    <link href="http://shane.hsi.rocks/2016/03/27/Why-is-this-inline-block-element-pushed-downward/"/>
    <id>http://shane.hsi.rocks/2016/03/27/Why-is-this-inline-block-element-pushed-downward/</id>
    <published>2016-03-27T11:21:34.000Z</published>
    <updated>2016-03-27T13:28:05.000Z</updated>
    <content type="html"><![CDATA[<p><a href="http://stackoverflow.com/questions/9273016/why-is-this-inline-block-element-pushed-downward" target="_blank" rel="external">Why is this inline-block element pushed downward?</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"firstDiv"</span>&gt;</span>FIRST<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"secondDiv"</span>&gt;</span>SECOND<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"thirdDiv"</span>&gt;</span>THIRD</span><br><span class="line">        <span class="tag">&lt;<span class="title">br</span>&gt;</span>some more content</span><br><span class="line">        <span class="tag">&lt;<span class="title">br</span>&gt;</span> some more content</span><br><span class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">body</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">350px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0px</span> auto</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="id">#container</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">15px</span> solid orange</span></span>;   </span><br><span class="line">&#125;</span></span><br><span class="line"><span class="id">#firstDiv</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">10px</span> solid brown</span></span>;     </span><br><span class="line">    <span class="rule"><span class="attribute">display</span>:<span class="value">inline-block</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">70px</span></span></span>;      </span><br><span class="line">    <span class="rule"><span class="attribute">overflow</span>:<span class="value">hidden</span></span>;  </span><br><span class="line">&#125;</span></span><br><span class="line"><span class="id">#secondDiv</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">10px</span> solid skyblue</span></span>;         </span><br><span class="line">    <span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">70px</span></span></span>;     </span><br><span class="line">&#125;</span></span><br><span class="line"><span class="id">#thirdDiv</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">display</span>:<span class="value">inline-block</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">5px</span> solid yellowgreen</span></span>;    </span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>回到：</p>
<p>Basically you have added more clutter in your code which is creating more confusion so first I try to remove clutter which hinders understanding the real issue.</p>
<p>First of all we have to establish that what’s the real question? Its that why “inline-block” element is pushed downward.</p>
<p>首先看下，</p>
<p>Now we start to understand it and remove the clutter first.</p>
<p>Here comes the turn of some <a href="http://www.w3.org/TR/CSS2/visudet.html#leading" target="_blank" rel="external">literature</a> to grasp the idea of line boxes and how they are lined in the same line esp read last paragraph carefully because there lies the answer of your question.</p>
<blockquote>
<p>The baseline of an ‘inline-block’ is the baseline of its last line box in the normal flow, unless it has either no in-flow line boxes or if its ‘overflow’ property has a computed value other than ‘visible’, in which case the baseline is the bottom margin edge.</p>
</blockquote>
<p>If you are not sure about <a href="http://www.w3.org/TR/CSS2/visudet.html#leading" target="_blank" rel="external">baseline</a> then here is brief explanation in simple words.</p>
<p>inline-block 的 baseline 是最后一个 line box 的 normal flow。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="http://stackoverflow.com/questions/9273016/why-is-this-inline-block-element-pushed-downward" target="_blank" rel="external">Why ]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[学习 react-redux 的 connect API]]></title>
    <link href="http://shane.hsi.rocks/2016/03/27/Learn-connect-API-of-react-redux/"/>
    <id>http://shane.hsi.rocks/2016/03/27/Learn-connect-API-of-react-redux/</id>
    <published>2016-03-27T06:52:52.000Z</published>
    <updated>2016-03-29T09:39:10.000Z</updated>
    <content type="html"><![CDATA[<p>这个 API 是设计的相当复杂啊。</p>
<p>从文档先了解下它实现的功能。</p>
<h3 id="connect_28_5BmapStateToProps_5D_2C__5BmapDispatchToProps_5D_2C__5BmergeProps_5D_2C__5Boptions_5D_29"><a href="#connect_28_5BmapStateToProps_5D_2C__5BmapDispatchToProps_5D_2C__5BmergeProps_5D_2C__5Boptions_5D_29" class="headerlink" title="connect([mapStateToProps], [mapDispatchToProps], [mergeProps], [options])"></a><code>connect([mapStateToProps], [mapDispatchToProps], [mergeProps], [options])</code></h3><p>Connects a React component to a Redux store.</p>
<p>将一个 React component 和一个 Redux store 连接起来。</p>
<p>It does not modify the component class passed to it.<br>Instead, it <em>returns</em> a new, connected component class, for you to use.</p>
<p>不会修改传入的 component，而是返回一个新的（curry）。</p>
<h4 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h4><ul>
<li>[<code>mapStateToProps(state, [ownProps]): stateProps</code>] (<em>Function</em>): If specified, the component will subscribe to Redux store updates. Any time it updates, <code>mapStateToProps</code> will be called. Its result must be a plain object*, and it will be merged into the component’s props. If you omit it, the component will not be subscribed to the Redux store. If <code>ownProps</code> is specified as a second argument, its value will be the props passed to your component, and <code>mapStateToProps</code> will be re-invoked whenever the component receives new props.</li>
</ul>
<ul>
<li>如果指定了，component 会订阅 Redux store 的 updates。每次它 update，<code>mapStateToProps</code> 就会被调用。</li>
<li>结果必须是 plain objects。</li>
<li>会被合并到 component 的 props。</li>
<li>如果省略了，不会订阅 store。</li>
<li><p>如果 ownProps，会传给 component，并且 <code>mapStateToProps</code> 会在每次 component 获取新的 props 被调用。</p>
<blockquote>
<p>Note: in advanced scenarios where you need more control over the rendering performance, <code>mapStateToProps()</code> can also return a function. In this case, <em>that</em> function will be used as <code>mapStateToProps()</code> for a particular component instance. This allows you to do per-instance memoization. You can refer to <a href="https://github.com/reactjs/react-redux/pull/279" target="_blank" rel="external">#279</a> and the tests it adds for more details. Most apps never need this.</p>
</blockquote>
</li>
</ul>
<ul>
<li>[<code>mapDispatchToProps(dispatch, [ownProps]): dispatchProps</code>] (<em>Object</em> or <em>Function</em>): If an object is passed, each function inside it will be assumed to be a Redux action creator. An object with the same function names, but with every action creator wrapped into a <code>dispatch</code> call so they may be invoked directly, will be merged into the component’s props. If a function is passed, it will be given <code>dispatch</code>. It’s up to you to return an object that somehow uses <code>dispatch</code> to bind action creators in your own way. (Tip: you may use the <a href="http://reactjs.github.io/redux/docs/api/bindActionCreators.html" target="_blank" rel="external"><code>bindActionCreators()</code></a> helper from Redux.) If you omit it, the default implementation just injects <code>dispatch</code> into your component’s props. If <code>ownProps</code> is specified as a second argument, its value will be the props passed to your component, and <code>mapDispatchToProps</code> will be re-invoked whenever the component receives new props.</li>
</ul>
<ul>
<li>如果传入的是 object，object 的每个 function 被认为是 actionCreator。一个新的 object， key 相同，但是会被包到 dispatch 里，会被 merge 到 props 里。</li>
<li>如果没有传入参数，则 dispatch 会被作为 props 传入。</li>
<li><p>如果 ownProps，会传给 component，并且 <code>mapDispatchToProps</code> 会在每次 component 获取新的 props 被调用。</p>
<blockquote>
<p>Note: in advanced scenarios where you need more control over the rendering performance, <code>mapDispatchToProps()</code> can also return a function. In this case, <em>that</em> function will be used as <code>mapDispatchToProps()</code> for a particular component instance. This allows you to do per-instance memoization. You can refer to <a href="https://github.com/reactjs/react-redux/pull/279" target="_blank" rel="external">#279</a> and the tests it adds for more details. Most apps never need this.</p>
</blockquote>
</li>
</ul>
<ul>
<li>[<code>mergeProps(stateProps, dispatchProps, ownProps): props</code>] (<em>Function</em>): If specified, it is passed the result of <code>mapStateToProps()</code>, <code>mapDispatchToProps()</code>, and the parent <code>props</code>. The plain object you return from it will be passed as props to the wrapped component. You may specify this function to select a slice of the state based on props, or to bind action creators to a particular variable from props. If you omit it, <code>Object.assign({}, ownProps, stateProps, dispatchProps)</code> is used by default.</li>
</ul>
<ul>
<li>默认是 <code>Object.assign({}, ownProps, stateProps, dispatchProps)</code></li>
</ul>
<ul>
<li>[<code>options</code>] <em>(Object)</em> If specified, further customizes the behavior of the connector.<ul>
<li>[<code>pure = true</code>] <em>(Boolean)</em>: If true, implements <code>shouldComponentUpdate</code> and shallowly compares the result of <code>mergeProps</code>, preventing unnecessary updates, assuming that the component is a “pure” component and does not rely on any input or state other than its props and the selected Redux store’s state. <em>Defaults to <code>true</code>.</em></li>
<li>[<code>withRef = false</code>] <em>(Boolean)</em>: If true, stores a ref to the wrapped component instance and makes it available via <code>getWrappedInstance()</code> method. <em>Defaults to <code>false</code>.</em></li>
</ul>
</li>
</ul>
<h4 id="Returns"><a href="#Returns" class="headerlink" title="Returns"></a>Returns</h4><p>A React component class that injects state and action creators into your component according to the specified options.</p>
<h5 id="Static_Properties"><a href="#Static_Properties" class="headerlink" title="Static Properties"></a>Static Properties</h5><ul>
<li><code>WrappedComponent</code> <em>(Component)</em>: The original component class passed to <code>connect()</code>.</li>
</ul>
<h5 id="Static_Methods"><a href="#Static_Methods" class="headerlink" title="Static Methods"></a>Static Methods</h5><p>All the original static methods of the component are hoisted.</p>
<h5 id="Instance_Methods"><a href="#Instance_Methods" class="headerlink" title="Instance Methods"></a>Instance Methods</h5><h6 id="getWrappedInstance_28_29_3A_ReactComponent"><a href="#getWrappedInstance_28_29_3A_ReactComponent" class="headerlink" title="getWrappedInstance(): ReactComponent"></a><code>getWrappedInstance(): ReactComponent</code></h6><p>Returns the wrapped component instance. Only available if you pass <code>{ withRef: true }</code> as part of the <code>connect()</code>’s fourth <code>options</code> argument.</p>
<h4 id="Remarks"><a href="#Remarks" class="headerlink" title="Remarks"></a>Remarks</h4><ul>
<li><p>It needs to be invoked two times. The first time with its arguments described above, and a second time, with the component: <code>connect(mapStateToProps, mapDispatchToProps, mergeProps)(MyComponent)</code>.</p>
</li>
<li><p>It does not modify the passed React component. It returns a new, connected component, that you should use instead.</p>
</li>
<li><p>The <code>mapStateToProps</code> function takes a single argument of the entire Redux store’s state and returns an object to be passed as props. It is often called a <strong>selector</strong>. Use <a href="https://github.com/reactjs/reselect" target="_blank" rel="external">reselect</a> to efficiently compose selectors and <a href="http://redux.js.org/docs/recipes/ComputingDerivedData.html" target="_blank" rel="external">compute derived data</a>.</p>
</li>
</ul>
<h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><h5 id="Inject_just_dispatch_and_don_u2019t_listen_to_store"><a href="#Inject_just_dispatch_and_don_u2019t_listen_to_store" class="headerlink" title="Inject just dispatch and don’t listen to store"></a>Inject just <code>dispatch</code> and don’t listen to store</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect()(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_dispatch_and_every_field_in_the_global_state"><a href="#Inject_dispatch_and_every_field_in_the_global_state" class="headerlink" title="Inject dispatch and every field in the global state"></a>Inject <code>dispatch</code> and every field in the global state</h5><blockquote>
<p>Don’t do this! It kills any performance optimizations because <code>TodoApp</code> will rerender after every action.<br>It’s better to have more granular <code>connect()</code> on several components in your view hierarchy that each only<br>listen to a relevant slice of the state.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(state =&gt; state)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_dispatch_and_todos"><a href="#Inject_dispatch_and_todos" class="headerlink" title="Inject dispatch and todos"></a>Inject <code>dispatch</code> and <code>todos</code></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_and_all_action_creators__28addTodo_2C_completeTodo_2C__u2026_29"><a href="#Inject_todos_and_all_action_creators__28addTodo_2C_completeTodo_2C__u2026_29" class="headerlink" title="Inject todos and all action creators (addTodo, completeTodo, …)"></a>Inject <code>todos</code> and all action creators (<code>addTodo</code>, <code>completeTodo</code>, …)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'./actionCreators'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, actionCreators)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_and_all_action_creators__28addTodo_2C_completeTodo_2C__u2026_29_as_actions"><a href="#Inject_todos_and_all_action_creators__28addTodo_2C_completeTodo_2C__u2026_29_as_actions" class="headerlink" title="Inject todos and all action creators (addTodo, completeTodo, …) as actions"></a>Inject <code>todos</code> and all action creators (<code>addTodo</code>, <code>completeTodo</code>, …) as <code>actions</code></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'./actionCreators'</span></span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return &#123; actions: bindActionCreators(actionCreators, dispatch) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_and_a_specific_action_creator__28addTodo_29"><a href="#Inject_todos_and_a_specific_action_creator__28addTodo_29" class="headerlink" title="Inject todos and a specific action creator (addTodo)"></a>Inject <code>todos</code> and a specific action creator (<code>addTodo</code>)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; addTodo &#125; <span class="keyword">from</span> <span class="string">'./actionCreators'</span></span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return bindActionCreators(&#123; addTodo &#125;, dispatch)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_2C_todoActionCreators_as_todoActions_2C_and_counterActionCreators_as_counterActions"><a href="#Inject_todos_2C_todoActionCreators_as_todoActions_2C_and_counterActionCreators_as_counterActions" class="headerlink" title="Inject todos, todoActionCreators as todoActions, and counterActionCreators as counterActions"></a>Inject <code>todos</code>, todoActionCreators as <code>todoActions</code>, and counterActionCreators as <code>counterActions</code></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> todoActionCreators <span class="keyword">from</span> <span class="string">'./todoActionCreators'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> counterActionCreators <span class="keyword">from</span> <span class="string">'./counterActionCreators'</span></span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    todoActions: bindActionCreators(todoActionCreators, dispatch),</span><br><span class="line">    counterActions: bindActionCreators(counterActionCreators, dispatch)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_2C_and_todoActionCreators_and_counterActionCreators_together_as_actions"><a href="#Inject_todos_2C_and_todoActionCreators_and_counterActionCreators_together_as_actions" class="headerlink" title="Inject todos, and todoActionCreators and counterActionCreators together as actions"></a>Inject <code>todos</code>, and todoActionCreators and counterActionCreators together as <code>actions</code></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> todoActionCreators <span class="keyword">from</span> <span class="string">'./todoActionCreators'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> counterActionCreators <span class="keyword">from</span> <span class="string">'./counterActionCreators'</span></span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    actions: bindActionCreators(Object.assign(&#123;&#125;, todoActionCreators, counterActionCreators), dispatch)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_2C_and_all_todoActionCreators_and_counterActionCreators_directly_as_props"><a href="#Inject_todos_2C_and_all_todoActionCreators_and_counterActionCreators_directly_as_props" class="headerlink" title="Inject todos, and all todoActionCreators and counterActionCreators directly as props"></a>Inject <code>todos</code>, and all todoActionCreators and counterActionCreators directly as props</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> todoActionCreators <span class="keyword">from</span> <span class="string">'./todoActionCreators'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> counterActionCreators <span class="keyword">from</span> <span class="string">'./counterActionCreators'</span></span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return bindActionCreators(Object.assign(&#123;&#125;, todoActionCreators, counterActionCreators), dispatch)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_of_a_specific_user_depending_on_props"><a href="#Inject_todos_of_a_specific_user_depending_on_props" class="headerlink" title="Inject todos of a specific user depending on props"></a>Inject <code>todos</code> of a specific user depending on props</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'./actionCreators'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state, ownProps) &#123;</span><br><span class="line">  return &#123; todos: state.todos[ownProps.userId] &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps)(TodoApp)</span><br></pre></td></tr></table></figure>
<h5 id="Inject_todos_of_a_specific_user_depending_on_props_2C_and_inject_props-userId_into_the_action"><a href="#Inject_todos_of_a_specific_user_depending_on_props_2C_and_inject_props-userId_into_the_action" class="headerlink" title="Inject todos of a specific user depending on props, and inject props.userId into the action"></a>Inject <code>todos</code> of a specific user depending on props, and inject <code>props.userId</code> into the action</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'./actionCreators'</span></span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mergeProps(stateProps, dispatchProps, ownProps) &#123;</span><br><span class="line">  return Object.assign(&#123;&#125;, ownProps, &#123;</span><br><span class="line">    todos: stateProps.todos[ownProps.userId],</span><br><span class="line">    addTodo: (text) =&gt; dispatchProps.addTodo(ownProps.userId, text)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, actionCreators, mergeProps)(TodoApp)</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>这个 API 是设计的相当复杂啊。</p>
<p>从文档先了解下它实现的功能。</p>
<h3 id="connect_28_5BmapStateToProps_5D_2C__5BmapDispatchToProps_5D_2C__5BmergeProps_5D_2C__5]]>
    </summary>
    
  </entry>
  
</feed>
